<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Module      :  Data.PQueue.Min</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Copyright   :  (c) Louis Wasserman 2010</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- General purpose priority queue, supporting view-maximum operations.</span><span>
</span><a name="line-13"></a><span class="hs-comment">--</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- An amortized running time is given for each operation, with /n/ referring</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- to the length of the sequence and /k/ being the integral index used by</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- some operations.  These bounds hold even in a persistent (shared) setting.</span><span>
</span><a name="line-17"></a><span class="hs-comment">--</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- This implementation is based on a binomial heap augmented with a global root.</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- The spine of the heap is maintained lazily.  To force the spine of the heap,</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- use 'seqSpine'.</span><span>
</span><a name="line-21"></a><span class="hs-comment">--</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- This implementation does not guarantee stable behavior.</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- </span><span>
</span><a name="line-24"></a><span class="hs-comment">-- This implementation offers a number of methods of the form @xxxU@, where @U@ stands for</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- unordered.  No guarantees whatsoever are made on the execution or traversal order of</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- these functions.</span><span>
</span><a name="line-27"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-28"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Max</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-29"></a><span>  </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>  </span><span class="hs-comment">-- * Basic operations</span><span>
</span><a name="line-31"></a><span>  </span><a href="Data.PQueue.Max.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><a href="Data.PQueue.Max.html#null"><span class="hs-identifier hs-var">null</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="Data.PQueue.Max.html#size"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-comment">-- * Query operations</span><span>
</span><a name="line-35"></a><span>  </span><a href="Data.PQueue.Max.html#findMax"><span class="hs-identifier hs-var">findMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>  </span><a href="Data.PQueue.Max.html#getMax"><span class="hs-identifier hs-var">getMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>  </span><a href="Data.PQueue.Max.html#deleteMax"><span class="hs-identifier hs-var">deleteMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>  </span><a href="Data.PQueue.Max.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>  </span><a href="Data.PQueue.Max.html#delete"><span class="hs-identifier hs-var">delete</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a href="Data.PQueue.Max.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-comment">-- * Construction operations</span><span>
</span><a name="line-42"></a><span>  </span><a href="Data.PQueue.Max.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>  </span><a href="Data.PQueue.Max.html#insert"><span class="hs-identifier hs-var">insert</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>  </span><a href="Data.PQueue.Max.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><a href="Data.PQueue.Max.html#unions"><span class="hs-identifier hs-var">unions</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>  </span><span class="hs-comment">-- * Subsets</span><span>
</span><a name="line-47"></a><span>  </span><span class="hs-comment">-- ** Extracting subsets</span><span>
</span><a name="line-48"></a><span>  </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#%21%21"><span class="hs-operator hs-var">!!</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>  </span><a href="Data.PQueue.Max.html#take"><span class="hs-identifier hs-var">take</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>  </span><a href="Data.PQueue.Max.html#drop"><span class="hs-identifier hs-var">drop</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>  </span><a href="Data.PQueue.Max.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>  </span><span class="hs-comment">-- ** Predicates</span><span>
</span><a name="line-53"></a><span>  </span><a href="Data.PQueue.Max.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a href="Data.PQueue.Max.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>  </span><a href="Data.PQueue.Max.html#span"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>  </span><a href="Data.PQueue.Max.html#break"><span class="hs-identifier hs-var">break</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-comment">-- * Filter/Map</span><span>
</span><a name="line-58"></a><span>  </span><a href="Data.PQueue.Max.html#filter"><span class="hs-identifier hs-var">filter</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>  </span><a href="Data.PQueue.Max.html#partition"><span class="hs-identifier hs-var">partition</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>  </span><a href="Data.PQueue.Max.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>  </span><a href="Data.PQueue.Max.html#mapEither"><span class="hs-identifier hs-var">mapEither</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-comment">-- * Fold\/Functor\/Traversable variations</span><span>
</span><a name="line-63"></a><span>  </span><span class="hs-identifier hs-var">map</span><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>  </span><a href="Data.PQueue.Max.html#foldrAsc"><span class="hs-identifier hs-var">foldrAsc</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>  </span><a href="Data.PQueue.Max.html#foldlAsc"><span class="hs-identifier hs-var">foldlAsc</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>  </span><a href="Data.PQueue.Max.html#foldrDesc"><span class="hs-identifier hs-var">foldrDesc</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>  </span><a href="Data.PQueue.Max.html#foldlDesc"><span class="hs-identifier hs-var">foldlDesc</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-comment">-- * List operations</span><span>
</span><a name="line-69"></a><span>  </span><a href="Data.PQueue.Max.html#toList"><span class="hs-identifier hs-var">toList</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>  </span><a href="Data.PQueue.Max.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>  </span><a href="Data.PQueue.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>  </span><a href="Data.PQueue.Max.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span class="hs-special">,</span><span>
</span><a name="line-73"></a><span>  </span><a href="Data.PQueue.Max.html#fromAscList"><span class="hs-identifier hs-var">fromAscList</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>  </span><a href="Data.PQueue.Max.html#fromDescList"><span class="hs-identifier hs-var">fromDescList</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>  </span><span class="hs-comment">-- * Unordered operations</span><span>
</span><a name="line-76"></a><span>  </span><a href="Data.PQueue.Max.html#mapU"><span class="hs-identifier hs-var">mapU</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>  </span><a href="Data.PQueue.Max.html#foldrU"><span class="hs-identifier hs-var">foldrU</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>  </span><a href="Data.PQueue.Max.html#foldlU"><span class="hs-identifier hs-var">foldlU</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>  </span><a href="Data.PQueue.Max.html#elemsU"><span class="hs-identifier hs-var">elemsU</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>  </span><a href="Data.PQueue.Max.html#toListU"><span class="hs-identifier hs-var">toListU</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-comment">-- * Miscellaneous operations</span><span>
</span><a name="line-82"></a><span>  </span><a href="Data.PQueue.Max.html#keysQueue"><span class="hs-identifier hs-var">keysQueue</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>  </span><a href="Data.PQueue.Max.html#seqSpine"><span class="hs-identifier hs-var">seqSpine</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;$&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">DeepSeq</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-89"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-90"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldr</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Traversable</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.PQueue.Min.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Min</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Min</span><span>
</span><a name="line-94"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Prio</span><span class="hs-operator">.</span><span class="hs-identifier">Max</span><span class="hs-operator">.</span><span class="hs-identifier">Internals</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Prio</span><span>
</span><a name="line-95"></a><span class="hs-keyword">import</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Prio</span><span class="hs-operator">.</span><span class="hs-identifier">Max</span><span class="hs-operator">.</span><span class="hs-identifier">Internals</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-type">Down</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">take</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">drop</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">span</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">break</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-100"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Lexeme</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">lexP</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parens</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prec</span><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-identifier hs-var">readPrec</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readListPrec</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readListPrecDefault</span><span class="hs-special">)</span><span>
</span><a name="line-103"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span>
</span><a name="line-104"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-105"></a><span class="hs-identifier">build</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-106"></a><span class="hs-identifier">build</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-107"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">-- | A priority queue with elements of type @a@.  Supports extracting the maximum element.  </span><span>
</span><a name="line-110"></a><span class="hs-comment">-- Implemented as a wrapper around 'Min.MinQueue'.</span><span>
</span><a name="line-111"></a><span class="hs-keyword">newtype</span><span> </span><a name="MaxQueue"><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier">MaxQueue</span></a></a><span> </span><a name="local-1627445641"><a href="#local-1627445641"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="MaxQ"><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier">MaxQ</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Internals.html#MinQueue"><span class="hs-identifier hs-type">Min</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MinQueue</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-type">Down</span></a><span> </span><a href="#local-1627445641"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span class="hs-cpp"># if __GLASGOW_HASKELL__</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">)</span><span>
</span><a name="line-114"></a><span class="hs-cpp"># else</span><span>
</span><a name="line-115"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span class="hs-cpp"># endif</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><a href="#local-1627445773"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">NFData</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445773"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-119"></a><span>  </span><a name="local-1912608890"><span class="hs-identifier">rnf</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445774"><a href="#local-1627445774"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">rnf</span><span> </span><a href="#local-1627445774"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-1627445770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445770"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>  </span><a name="local-1912608631"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-1627445771"><a href="#local-1627445771"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627445772"><a href="#local-1627445772"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-1627445771"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;fromDescList &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span> </span><a href="#local-1627445772"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>    </span><span>
</span><a name="line-125"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-1627445768"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445768"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-126"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-127"></a><span>  </span><a name="local-1912608343"><span class="hs-identifier">readPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parens</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-string">&quot;fromDescList&quot;</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lexP</span><span>
</span><a name="line-129"></a><span>    </span><a name="local-1627445769"><a href="#local-1627445769"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readPrec</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#fromDescList"><span class="hs-identifier hs-var">fromDescList</span></a><span> </span><a href="#local-1627445769"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span>  </span><a name="local-1912608342"><span class="hs-identifier">readListPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readListPrecDefault</span><span>
</span><a name="line-133"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;fromDescList&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-136"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">reads</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromDescList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445767"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445767"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-141"></a><span>  </span><a name="local-805306882"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-142"></a><span>  </span><a name="local-805306883"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#union"><span class="hs-identifier hs-var">union</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-comment">-- | /O(1)/.  The empty priority queue.</span><span>
</span><a name="line-145"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445695"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-146"></a><a name="empty"><a href="Data.PQueue.Max.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="Data.PQueue.Internals.html#empty"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">-- | /O(1)/.  Is this the empty priority queue?</span><span>
</span><a name="line-149"></a><span class="hs-identifier">null</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445694"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-150"></a><a name="null"><a href="Data.PQueue.Max.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445696"><a href="#local-1627445696"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#null"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627445696"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-151"></a><span>
</span><a name="line-152"></a><span class="hs-comment">-- | /O(1)/.  The number of elements in the queue.</span><span>
</span><a name="line-153"></a><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445693"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-154"></a><a name="size"><a href="Data.PQueue.Max.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445697"><a href="#local-1627445697"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#size"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-1627445697"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span class="hs-comment">-- | /O(1)/.  Returns the maximum element of the queue.  Throws an error on an empty queue.</span><span>
</span><a name="line-157"></a><span class="hs-identifier">findMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445692"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445692"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-158"></a><a name="findMax"><a href="Data.PQueue.Max.html#findMax"><span class="hs-identifier">findMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error: findMax called on empty queue&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Max.html#getMax"><span class="hs-identifier hs-var">getMax</span></a><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span class="hs-comment">-- | /O(1)/.  The top (maximum) element of the queue, if there is one.</span><span>
</span><a name="line-161"></a><span class="hs-identifier">getMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445691"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627445691"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-162"></a><a name="getMax"><a href="Data.PQueue.Max.html#getMax"><span class="hs-identifier">getMax</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445698"><a href="#local-1627445698"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unDown</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.PQueue.Internals.html#getMin"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getMin</span></a><span> </span><a href="#local-1627445698"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- | /O(log n)/.  Deletes the maximum element of the queue.  Does nothing on an empty queue.</span><span>
</span><a name="line-165"></a><span class="hs-identifier">deleteMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445690"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445690"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445690"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-166"></a><a name="deleteMax"><a href="Data.PQueue.Max.html#deleteMax"><span class="hs-identifier">deleteMax</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445699"><a href="#local-1627445699"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#deleteMin"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">deleteMin</span></a><span> </span><a href="#local-1627445699"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-comment">-- | /O(log n)/.  Extracts the maximum element of the queue.  Throws an error on an empty queue.</span><span>
</span><a name="line-169"></a><span class="hs-identifier">deleteFindMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445689"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445689"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445689"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445689"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><a name="deleteFindMax"><a href="Data.PQueue.Max.html#deleteFindMax"><span class="hs-identifier">deleteFindMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error: deleteFindMax called on empty queue&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Max.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span class="hs-comment">-- | /O(log n)/.  Extract the top (maximum) element of the sequence, if there is one.</span><span>
</span><a name="line-173"></a><span class="hs-identifier">maxView</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445688"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445688"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-1627445688"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445688"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-174"></a><a name="maxView"><a href="Data.PQueue.Max.html#maxView"><span class="hs-identifier">maxView</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445700"><a href="#local-1627445700"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.PQueue.Internals.html#minView"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">minView</span></a><span> </span><a href="#local-1627445700"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-175"></a><span>  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-176"></a><span>  </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a name="local-1627445701"><a href="#local-1627445701"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627445702"><a href="#local-1627445702"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-1627445701"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445702"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>    </span><span>
</span><a name="line-179"></a><span class="hs-comment">-- | /O(log n)/.  Delete the top (maximum) element of the sequence, if there is one.</span><span>
</span><a name="line-180"></a><span class="hs-identifier">delete</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445687"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445687"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445687"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-181"></a><a name="delete"><a href="Data.PQueue.Max.html#delete"><span class="hs-identifier">delete</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Max.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span class="hs-comment">-- | /O(1)/.  Construct a priority queue with a single element.</span><span>
</span><a name="line-184"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627445686"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445686"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-185"></a><a name="singleton"><a href="Data.PQueue.Max.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Internals.html#singleton"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- | /O(1)/.  Insert an element into the priority queue.  </span><span>
</span><a name="line-188"></a><span class="hs-identifier">insert</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445685"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627445685"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445685"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445685"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-189"></a><a name="local-1627445703"><a href="#local-1627445703"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">`</span><a name="insert"><a href="Data.PQueue.Max.html#insert"><span class="hs-identifier">insert</span></a></a><span class="hs-special">`</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445704"><a href="#local-1627445704"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a href="#local-1627445703"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="Data.PQueue.Internals.html#insert"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627445704"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | /O(log (min(n1,n2)))/.  Take the union of two priority queues.</span><span>
</span><a name="line-192"></a><span class="hs-identifier">union</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445684"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445684"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445684"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445684"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-193"></a><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445705"><a href="#local-1627445705"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-special">`</span><a name="union"><a href="Data.PQueue.Max.html#union"><span class="hs-identifier">union</span></a></a><span class="hs-special">`</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445706"><a href="#local-1627445706"><span class="hs-identifier">q2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445705"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-special">`</span><a href="Data.PQueue.Internals.html#union"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627445706"><span class="hs-identifier hs-var">q2</span></a><span class="hs-special">)</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- | Takes the union of a list of priority queues.  Equivalent to @'foldl' 'union' 'empty'@.</span><span>
</span><a name="line-196"></a><span class="hs-identifier">unions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445683"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445683"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445683"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-197"></a><a name="unions"><a href="Data.PQueue.Max.html#unions"><span class="hs-identifier">unions</span></a></a><span> </span><a name="local-1627445707"><a href="#local-1627445707"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#unions"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unions</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627445708"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445708"><a href="#local-1627445708"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627445707"><span class="hs-identifier hs-var">qs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">-- | /O(k log n)/.  Returns the @(k+1)@th largest element of the queue.</span><span>
</span><a name="line-200"></a><span class="hs-special">(</span><span class="hs-operator">!!</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445682"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445682"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445682"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-201"></a><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445709"><a href="#local-1627445709"><span class="hs-identifier">q</span></a></a><span> </span><a name="%21%21"><a href="Data.PQueue.Max.html#%21%21"><span class="hs-operator">!!</span></a></a><span> </span><a name="local-1627445710"><a href="#local-1627445710"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">unDown</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#%21%21"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.!!</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627445709"><span class="hs-identifier hs-var">q</span></a><span> </span><a href="#local-1627445710"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-pragma">{-# INLINE take #-}</span><span>
</span><a name="line-204"></a><span class="hs-comment">-- | /O(k log n)/.  Returns the list of the @k@ largest elements of the queue, in descending order, or</span><span>
</span><a name="line-205"></a><span class="hs-comment">-- all elements of the queue, if @k &gt;= n@.</span><span>
</span><a name="line-206"></a><span class="hs-identifier">take</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445681"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445681"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445681"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-207"></a><a name="take"><a href="Data.PQueue.Max.html#take"><span class="hs-identifier">take</span></a></a><span> </span><a name="local-1627445711"><a href="#local-1627445711"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445712"><a href="#local-1627445712"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-1627445713"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a name="local-1627445713"><a href="#local-1627445713"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.PQueue.Min.html#take"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1627445711"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627445712"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">]</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | /O(k log n)/.  Returns the queue with the @k@ largest elements deleted, or the empty queue if @k &gt;= n@.</span><span>
</span><a name="line-210"></a><span class="hs-identifier">drop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445680"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445680"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445680"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-211"></a><a name="drop"><a href="Data.PQueue.Max.html#drop"><span class="hs-identifier">drop</span></a></a><span> </span><a name="local-1627445714"><a href="#local-1627445714"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445715"><a href="#local-1627445715"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#drop"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">drop</span></a><span> </span><a href="#local-1627445714"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627445715"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span class="hs-comment">-- | /O(k log n)/.  Equivalent to @(take k queue, drop k queue)@.</span><span>
</span><a name="line-214"></a><span class="hs-identifier">splitAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445679"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445679"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1627445679"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445679"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-215"></a><a name="splitAt"><a href="Data.PQueue.Max.html#splitAt"><span class="hs-identifier">splitAt</span></a></a><span> </span><a name="local-1627445716"><a href="#local-1627445716"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445717"><a href="#local-1627445717"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">unDown</span><span> </span><a href="#local-1627445718"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445719"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-216"></a><span>  </span><span class="hs-special">(</span><a name="local-1627445718"><a href="#local-1627445718"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627445719"><a href="#local-1627445719"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Min.html#splitAt"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-1627445716"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627445717"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-217"></a><span>  </span><span>
</span><a name="line-218"></a><span class="hs-comment">-- | 'takeWhile', applied to a predicate @p@ and a queue @queue@, returns the</span><span>
</span><a name="line-219"></a><span class="hs-comment">-- longest prefix (possibly empty) of @queue@ of elements that satisfy @p@.</span><span>
</span><a name="line-220"></a><span class="hs-identifier">takeWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445678"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445678"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-221"></a><a name="takeWhile"><a href="Data.PQueue.Max.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></a><span> </span><a name="local-1627445720"><a href="#local-1627445720"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445721"><a href="#local-1627445721"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">unDown</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#takeWhile"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">takeWhile</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445720"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627445721"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">-- | 'dropWhile' @p queue@ returns the queue remaining after 'takeWhile' @p queue@.</span><span>
</span><a name="line-224"></a><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445677"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-225"></a><a name="dropWhile"><a href="Data.PQueue.Max.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></a><span> </span><a name="local-1627445722"><a href="#local-1627445722"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445723"><a href="#local-1627445723"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#dropWhile"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">dropWhile</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445722"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627445723"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-comment">-- | 'span', applied to a predicate @p@ and a queue @queue@, returns a tuple where</span><span>
</span><a name="line-228"></a><span class="hs-comment">-- first element is longest prefix (possibly empty) of @queue@ of elements that</span><span>
</span><a name="line-229"></a><span class="hs-comment">-- satisfy @p@ and second element is the remainder of the queue.</span><span>
</span><a name="line-230"></a><span class="hs-comment">-- </span><span>
</span><a name="line-231"></a><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445676"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445676"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445676"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1627445676"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445676"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><a name="span"><a href="Data.PQueue.Max.html#span"><span class="hs-identifier">span</span></a></a><span> </span><a name="local-1627445724"><a href="#local-1627445724"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445725"><a href="#local-1627445725"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">unDown</span><span> </span><a href="#local-1627445726"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445727"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-233"></a><span>  </span><span class="hs-special">(</span><a name="local-1627445726"><a href="#local-1627445726"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627445727"><a href="#local-1627445727"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Min.html#span"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445724"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627445725"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">-- | 'break', applied to a predicate @p@ and a queue @queue@, returns a tuple where</span><span>
</span><a name="line-236"></a><span class="hs-comment">-- first element is longest prefix (possibly empty) of @queue@ of elements that</span><span>
</span><a name="line-237"></a><span class="hs-comment">-- /do not satisfy/ @p@ and second element is the remainder of the queue.</span><span>
</span><a name="line-238"></a><span class="hs-identifier">break</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445675"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445675"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445675"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-1627445675"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445675"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-239"></a><a name="break"><a href="Data.PQueue.Max.html#break"><span class="hs-identifier">break</span></a></a><span> </span><a name="local-1627445728"><a href="#local-1627445728"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#span"><span class="hs-identifier hs-var">span</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-1627445728"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-comment">-- | /O(n)/.  Returns a queue of those elements which satisfy the predicate.</span><span>
</span><a name="line-242"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445674"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445674"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445674"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445674"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-243"></a><a name="filter"><a href="Data.PQueue.Max.html#filter"><span class="hs-identifier">filter</span></a></a><span> </span><a name="local-1627445729"><a href="#local-1627445729"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445730"><a href="#local-1627445730"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#filter"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">filter</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445729"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627445730"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">-- | /O(n)/.  Returns a pair of queues, where the left queue contains those elements that satisfy the predicate,</span><span>
</span><a name="line-246"></a><span class="hs-comment">-- and the right queue contains those that do not.</span><span>
</span><a name="line-247"></a><span class="hs-identifier">partition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445673"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445673"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445673"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-248"></a><a name="partition"><a href="Data.PQueue.Max.html#partition"><span class="hs-identifier">partition</span></a></a><span> </span><a name="local-1627445731"><a href="#local-1627445731"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445732"><a href="#local-1627445732"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445733"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445734"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-249"></a><span>  </span><span class="hs-keyword">where</span><span>  </span><span class="hs-special">(</span><a name="local-1627445733"><a href="#local-1627445733"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627445734"><a href="#local-1627445734"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Min.html#partition"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">partition</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445731"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627445732"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">-- | /O(n)/.  Maps a function over the elements of the queue, and collects the 'Just' values.</span><span>
</span><a name="line-252"></a><span class="hs-identifier">mapMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445671"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445672"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627445671"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445672"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445671"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-253"></a><a name="mapMaybe"><a href="Data.PQueue.Max.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></a><span> </span><a name="local-1627445735"><a href="#local-1627445735"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445736"><a href="#local-1627445736"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Internals.html#mapMaybe"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapMaybe</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a name="local-1627445737"><a href="#local-1627445737"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-1627445735"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627445737"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627445736"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span class="hs-comment">-- | /O(n)/.  Maps a function over the elements of the queue, and separates the 'Left' and 'Right' values.</span><span>
</span><a name="line-256"></a><span class="hs-identifier">mapEither</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445668"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445669"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445670"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-1627445668"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627445669"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445670"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445668"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445669"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-257"></a><a name="mapEither"><a href="Data.PQueue.Max.html#mapEither"><span class="hs-identifier">mapEither</span></a></a><span> </span><a name="local-1627445738"><a href="#local-1627445738"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445739"><a href="#local-1627445739"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445740"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a href="#local-1627445741"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-keyword">where</span><span>  </span><span class="hs-special">(</span><a name="local-1627445740"><a href="#local-1627445740"><span class="hs-identifier">q0</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627445741"><a href="#local-1627445741"><span class="hs-identifier">q1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#mapEither"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapEither</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">either</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-1627445738"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627445739"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-comment">-- | /O(n)/.  Assumes that the function it is given is monotonic, and applies this function to every element of the priority queue.</span><span>
</span><a name="line-261"></a><span class="hs-comment">-- /Does not check the precondition/.</span><span>
</span><a name="line-262"></a><span class="hs-identifier">mapU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627445666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445667"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445666"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445667"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-263"></a><a name="mapU"><a href="Data.PQueue.Max.html#mapU"><span class="hs-identifier">mapU</span></a></a><span> </span><a name="local-1627445742"><a href="#local-1627445742"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445743"><a href="#local-1627445743"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#mapU"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapU</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a name="local-1627445744"><a href="#local-1627445744"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627445742"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627445744"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627445743"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- | /O(n)/.  Unordered right fold on a priority queue.</span><span>
</span><a name="line-266"></a><span class="hs-identifier">foldrU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627445664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445665"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445665"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445665"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445664"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445665"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-267"></a><a name="foldrU"><a href="Data.PQueue.Max.html#foldrU"><span class="hs-identifier">foldrU</span></a></a><span> </span><a name="local-1627445745"><a href="#local-1627445745"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627445746"><a href="#local-1627445746"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445747"><a href="#local-1627445747"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#foldrU"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrU</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-1627445745"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627445746"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627445747"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-comment">-- | /O(n)/.  Unordered left fold on a priority queue.</span><span>
</span><a name="line-270"></a><span class="hs-identifier">foldlU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627445662"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445663"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445662"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445662"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445663"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445662"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-271"></a><a name="foldlU"><a href="Data.PQueue.Max.html#foldlU"><span class="hs-identifier">foldlU</span></a></a><span> </span><a name="local-1627445748"><a href="#local-1627445748"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627445749"><a href="#local-1627445749"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445750"><a href="#local-1627445750"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#foldlU"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldlU</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="#local-1627445748"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627445749"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627445750"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-pragma">{-# INLINE elemsU #-}</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- | Equivalent to 'toListU'.</span><span>
</span><a name="line-275"></a><span class="hs-identifier">elemsU</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445661"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445661"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-276"></a><a name="elemsU"><a href="Data.PQueue.Max.html#elemsU"><span class="hs-identifier">elemsU</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#toListU"><span class="hs-identifier hs-var">toListU</span></a><span>
</span><a name="line-277"></a><span>
</span><a name="line-278"></a><span class="hs-pragma">{-# INLINE toListU #-}</span><span>
</span><a name="line-279"></a><span class="hs-comment">-- | /O(n)/.  Returns a list of the elements of the priority queue, in no particular order.</span><span>
</span><a name="line-280"></a><span class="hs-identifier">toListU</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445660"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445660"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-281"></a><a name="toListU"><a href="Data.PQueue.Max.html#toListU"><span class="hs-identifier">toListU</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445751"><a href="#local-1627445751"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">unDown</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#toListU"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toListU</span></a><span> </span><a href="#local-1627445751"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- | /O(n log n)/.  Performs a right-fold on the elements of a priority queue in ascending order.</span><span>
</span><a name="line-284"></a><span class="hs-comment">-- @'foldrAsc' f z q == 'foldlDesc' (flip f) z q@.</span><span>
</span><a name="line-285"></a><span class="hs-identifier">foldrAsc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445658"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445658"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445659"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445659"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445659"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445658"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445659"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-286"></a><a name="foldrAsc"><a href="Data.PQueue.Max.html#foldrAsc"><span class="hs-identifier">foldrAsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#foldlDesc"><span class="hs-identifier hs-var">foldlDesc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-comment">-- | /O(n log n)/.  Performs a left-fold on the elements of a priority queue in descending order.</span><span>
</span><a name="line-289"></a><span class="hs-comment">-- @'foldlAsc' f z q == 'foldrDesc' (flip f) z q@.</span><span>
</span><a name="line-290"></a><span class="hs-identifier">foldlAsc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445656"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445657"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445656"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445657"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445657"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445656"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445657"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-291"></a><a name="foldlAsc"><a href="Data.PQueue.Max.html#foldlAsc"><span class="hs-identifier">foldlAsc</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#foldrDesc"><span class="hs-identifier hs-var">foldrDesc</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">-- | /O(n log n)/.  Performs a right-fold on the elements of a priority queue in descending order.</span><span>
</span><a name="line-294"></a><span class="hs-identifier">foldrDesc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445654"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445654"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445655"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445655"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445655"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445654"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445655"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-295"></a><a name="foldrDesc"><a href="Data.PQueue.Max.html#foldrDesc"><span class="hs-identifier">foldrDesc</span></a></a><span> </span><a name="local-1627445752"><a href="#local-1627445752"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627445753"><a href="#local-1627445753"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445754"><a href="#local-1627445754"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#foldrAsc"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrAsc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-1627445752"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-1627445753"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627445754"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-comment">-- | /O(n log n)/.  Performs a left-fold on the elements of a priority queue in descending order.</span><span>
</span><a name="line-298"></a><span class="hs-identifier">foldlDesc</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445652"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627445653"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445652"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445653"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445653"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445652"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445653"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-299"></a><a name="foldlDesc"><a href="Data.PQueue.Max.html#foldlDesc"><span class="hs-identifier">foldlDesc</span></a></a><span> </span><a name="local-1627445755"><a href="#local-1627445755"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627445756"><a href="#local-1627445756"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445757"><a href="#local-1627445757"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#foldlAsc"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldlAsc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="#local-1627445755"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627445756"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627445757"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-300"></a><span>
</span><a name="line-301"></a><span class="hs-pragma">{-# INLINE toAscList #-}</span><span>
</span><a name="line-302"></a><span class="hs-comment">-- | /O(n log n)/.  Extracts the elements of the priority queue in ascending order.</span><span>
</span><a name="line-303"></a><span class="hs-identifier">toAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445651"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445651"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445651"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-304"></a><a name="toAscList"><a href="Data.PQueue.Max.html#toAscList"><span class="hs-identifier">toAscList</span></a></a><span> </span><a name="local-1627445758"><a href="#local-1627445758"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627445759"><a href="#local-1627445759"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627445760"><a href="#local-1627445760"><span class="hs-identifier">nil</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#foldrAsc"><span class="hs-identifier hs-var">foldrAsc</span></a><span> </span><a href="#local-1627445759"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-1627445760"><span class="hs-identifier hs-var">nil</span></a><span> </span><a href="#local-1627445758"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-pragma">{-# INLINE toDescList #-}</span><span>
</span><a name="line-307"></a><span class="hs-comment">-- | /O(n log n)/.  Extracts the elements of the priority queue in descending order.</span><span>
</span><a name="line-308"></a><span class="hs-identifier">toDescList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445650"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445650"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445650"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-309"></a><a name="toDescList"><a href="Data.PQueue.Max.html#toDescList"><span class="hs-identifier">toDescList</span></a></a><span> </span><a name="local-1627445761"><a href="#local-1627445761"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627445762"><a href="#local-1627445762"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-1627445763"><a href="#local-1627445763"><span class="hs-identifier">nil</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#foldrDesc"><span class="hs-identifier hs-var">foldrDesc</span></a><span> </span><a href="#local-1627445762"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-1627445763"><span class="hs-identifier hs-var">nil</span></a><span> </span><a href="#local-1627445761"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-pragma">{-# INLINE toList #-}</span><span>
</span><a name="line-312"></a><span class="hs-comment">-- | /O(n)/.  Returns the elements of the priority queue in no particular order.</span><span>
</span><a name="line-313"></a><span class="hs-identifier">toList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445649"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445649"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445649"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-314"></a><a name="toList"><a href="Data.PQueue.Max.html#toList"><span class="hs-identifier">toList</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445764"><a href="#local-1627445764"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">unDown</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Min.html#toList"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span></a><span> </span><a href="#local-1627445764"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-pragma">{-# INLINE fromAscList #-}</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- | /O(n)/.  Constructs a priority queue from an ascending list.  /Warning/: Does not check the precondition. </span><span>
</span><a name="line-318"></a><span class="hs-identifier">fromAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-1627445648"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445648"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-319"></a><a name="fromAscList"><a href="Data.PQueue.Max.html#fromAscList"><span class="hs-identifier">fromAscList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Min.html#fromDescList"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromDescList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-pragma">{-# INLINE fromDescList #-}</span><span>
</span><a name="line-322"></a><span class="hs-comment">-- | /O(n)/.  Constructs a priority queue from a descending list.  /Warning/: Does not check the precondition.</span><span>
</span><a name="line-323"></a><span class="hs-identifier">fromDescList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-1627445647"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445647"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-324"></a><a name="fromDescList"><a href="Data.PQueue.Max.html#fromDescList"><span class="hs-identifier">fromDescList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Min.html#fromAscList"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromAscList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span class="hs-pragma">{-# INLINE fromList #-}</span><span>
</span><a name="line-327"></a><span class="hs-comment">-- | /O(n log n)/.  Constructs a priority queue from an unordered list.</span><span>
</span><a name="line-328"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627445646"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627445646"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445646"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-329"></a><a name="fromList"><a href="Data.PQueue.Max.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="Data.PQueue.Max.html#insert"><span class="hs-identifier hs-var">insert</span></a><span> </span><a href="Data.PQueue.Max.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-comment">-- | /O(n)/.  Constructs a priority queue from the keys of a 'Prio.MaxPQueue'.</span><span>
</span><a name="line-332"></a><span class="hs-identifier">keysQueue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">Prio</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627445644"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627445645"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445644"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-333"></a><a name="keysQueue"><a href="Data.PQueue.Max.html#keysQueue"><span class="hs-identifier">keysQueue</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">Prio</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627445765"><a href="#local-1627445765"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Internals.html#keysQueue"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keysQueue</span></a><span> </span><a href="#local-1627445765"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">-- | /O(log n)/.  Forces the spine of the heap.</span><span>
</span><a name="line-336"></a><span class="hs-identifier">seqSpine</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Max.html#MaxQueue"><span class="hs-identifier hs-type">MaxQueue</span></a><span> </span><a href="#local-1627445642"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445643"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627445643"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-337"></a><a name="seqSpine"><a href="Data.PQueue.Max.html#seqSpine"><span class="hs-identifier">seqSpine</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Max.html#MaxQ"><span class="hs-identifier hs-var">MaxQ</span></a><span> </span><a name="local-1627445766"><a href="#local-1627445766"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Internals.html#seqSpine"><span class="hs-identifier hs-var">Min</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">seqSpine</span></a><span> </span><a href="#local-1627445766"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-338"></a></pre></body></html>