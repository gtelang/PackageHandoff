<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><a name="line-3"></a><span>
</span><a name="line-4"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- Module      :  Data.PQueue.Prio.Max</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Copyright   :  (c) Louis Wasserman 2010</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- General purpose priority queue.</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Each element is associated with a /key/, and the priority queue supports</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- viewing and extracting the element with the maximum key.</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- A worst-case bound is given for each operation.  In some cases, an amortized</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- bound is also specified; these bounds do not hold in a persistent context.</span><span>
</span><a name="line-19"></a><span class="hs-comment">--</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- This implementation is based on a binomial heap augmented with a global root.</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- The spine of the heap is maintained lazily.  To force the spine of the heap,</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- use 'seqSpine'.</span><span>
</span><a name="line-23"></a><span class="hs-comment">-- </span><span>
</span><a name="line-24"></a><span class="hs-comment">-- We do not guarantee stable behavior.</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- Ties are broken arbitrarily -- that is, if @k1 &lt;= k2@ and @k2 &lt;= k1@, then there </span><span>
</span><a name="line-26"></a><span class="hs-comment">-- are no guarantees about the relative order in which @k1@, @k2@, and their associated</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- elements are returned.  (Unlike Data.Map, we allow multiple elements with the</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- same key.)</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- </span><span>
</span><a name="line-30"></a><span class="hs-comment">-- This implementation offers a number of methods of the form @xxxU@, where @U@ stands for</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- unordered.  No guarantees whatsoever are made on the execution or traversal order of</span><span>
</span><a name="line-32"></a><span class="hs-comment">-- these functions.</span><span>
</span><a name="line-33"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-34"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Prio</span><span class="hs-operator">.</span><span class="hs-identifier">Max</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-35"></a><span>  </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-comment">-- * Construction</span><span>
</span><a name="line-37"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#singleton"><span class="hs-identifier hs-var">singleton</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#insert"><span class="hs-identifier hs-var">insert</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#union"><span class="hs-identifier hs-var">union</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#unions"><span class="hs-identifier hs-var">unions</span></a><span class="hs-special">,</span><span> </span><span>
</span><a name="line-42"></a><span>  </span><span class="hs-comment">-- * Query</span><span>
</span><a name="line-43"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#null"><span class="hs-identifier hs-var">null</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#size"><span class="hs-identifier hs-var">size</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><span class="hs-comment">-- ** Maximum view</span><span>
</span><a name="line-46"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#findMax"><span class="hs-identifier hs-var">findMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#getMax"><span class="hs-identifier hs-var">getMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#deleteMax"><span class="hs-identifier hs-var">deleteMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#deleteFindMax"><span class="hs-identifier hs-var">deleteFindMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#adjustMax"><span class="hs-identifier hs-var">adjustMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#adjustMaxWithKey"><span class="hs-identifier hs-var">adjustMaxWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#updateMax"><span class="hs-identifier hs-var">updateMax</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#updateMaxWithKey"><span class="hs-identifier hs-var">updateMaxWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#maxView"><span class="hs-identifier hs-var">maxView</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#maxViewWithKey"><span class="hs-identifier hs-var">maxViewWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>  </span><span class="hs-comment">-- * Traversal</span><span>
</span><a name="line-57"></a><span>  </span><span class="hs-comment">-- ** Map</span><span>
</span><a name="line-58"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#map"><span class="hs-identifier hs-var">map</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapWithKey"><span class="hs-identifier hs-var">mapWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapKeys"><span class="hs-identifier hs-var">mapKeys</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapKeysMonotonic"><span class="hs-identifier hs-var">mapKeysMonotonic</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>  </span><span class="hs-comment">-- ** Fold</span><span>
</span><a name="line-63"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#foldrWithKey"><span class="hs-identifier hs-var">foldrWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#foldlWithKey"><span class="hs-identifier hs-var">foldlWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-comment">-- ** Traverse</span><span>
</span><a name="line-66"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#traverseWithKey"><span class="hs-identifier hs-var">traverseWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>  </span><span class="hs-comment">-- * Subsets</span><span>
</span><a name="line-68"></a><span>  </span><span class="hs-comment">-- ** Indexed</span><span>
</span><a name="line-69"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#take"><span class="hs-identifier hs-var">take</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#drop"><span class="hs-identifier hs-var">drop</span></a><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#splitAt"><span class="hs-identifier hs-var">splitAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-comment">-- ** Predicates</span><span>
</span><a name="line-73"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-74"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#takeWhileWithKey"><span class="hs-identifier hs-var">takeWhileWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-75"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#dropWhile"><span class="hs-identifier hs-var">dropWhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-76"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#dropWhileWithKey"><span class="hs-identifier hs-var">dropWhileWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-77"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#span"><span class="hs-identifier hs-var">span</span></a><span class="hs-special">,</span><span>
</span><a name="line-78"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#spanWithKey"><span class="hs-identifier hs-var">spanWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-79"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#break"><span class="hs-identifier hs-var">break</span></a><span class="hs-special">,</span><span>
</span><a name="line-80"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#breakWithKey"><span class="hs-identifier hs-var">breakWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-81"></a><span>  </span><span class="hs-comment">-- *** Filter</span><span>
</span><a name="line-82"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#filter"><span class="hs-identifier hs-var">filter</span></a><span class="hs-special">,</span><span>
</span><a name="line-83"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#filterWithKey"><span class="hs-identifier hs-var">filterWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-84"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#partition"><span class="hs-identifier hs-var">partition</span></a><span class="hs-special">,</span><span>
</span><a name="line-85"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#partitionWithKey"><span class="hs-identifier hs-var">partitionWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-86"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapMaybe"><span class="hs-identifier hs-var">mapMaybe</span></a><span class="hs-special">,</span><span>
</span><a name="line-87"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapMaybeWithKey"><span class="hs-identifier hs-var">mapMaybeWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-88"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapEither"><span class="hs-identifier hs-var">mapEither</span></a><span class="hs-special">,</span><span>
</span><a name="line-89"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#mapEitherWithKey"><span class="hs-identifier hs-var">mapEitherWithKey</span></a><span class="hs-special">,</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-comment">-- * List operations</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-comment">-- ** Conversion from lists</span><span>
</span><a name="line-92"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span class="hs-special">,</span><span>
</span><a name="line-93"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#fromAscList"><span class="hs-identifier hs-var">fromAscList</span></a><span class="hs-special">,</span><span>
</span><a name="line-94"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#fromDescList"><span class="hs-identifier hs-var">fromDescList</span></a><span class="hs-special">,</span><span>
</span><a name="line-95"></a><span>  </span><span class="hs-comment">-- ** Conversion to lists</span><span>
</span><a name="line-96"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#keys"><span class="hs-identifier hs-var">keys</span></a><span class="hs-special">,</span><span>
</span><a name="line-97"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#elems"><span class="hs-identifier hs-var">elems</span></a><span class="hs-special">,</span><span>
</span><a name="line-98"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#assocs"><span class="hs-identifier hs-var">assocs</span></a><span class="hs-special">,</span><span>
</span><a name="line-99"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#toAscList"><span class="hs-identifier hs-var">toAscList</span></a><span class="hs-special">,</span><span>
</span><a name="line-100"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span class="hs-special">,</span><span>
</span><a name="line-101"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#toList"><span class="hs-identifier hs-var">toList</span></a><span class="hs-special">,</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-comment">-- * Unordered operations</span><span>
</span><a name="line-103"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#foldrU"><span class="hs-identifier hs-var">foldrU</span></a><span class="hs-special">,</span><span>
</span><a name="line-104"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#foldrWithKeyU"><span class="hs-identifier hs-var">foldrWithKeyU</span></a><span class="hs-special">,</span><span>
</span><a name="line-105"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#foldlU"><span class="hs-identifier hs-var">foldlU</span></a><span class="hs-special">,</span><span>
</span><a name="line-106"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#foldlWithKeyU"><span class="hs-identifier hs-var">foldlWithKeyU</span></a><span class="hs-special">,</span><span>
</span><a name="line-107"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#traverseU"><span class="hs-identifier hs-var">traverseU</span></a><span class="hs-special">,</span><span>
</span><a name="line-108"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#traverseWithKeyU"><span class="hs-identifier hs-var">traverseWithKeyU</span></a><span class="hs-special">,</span><span>
</span><a name="line-109"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#keysU"><span class="hs-identifier hs-var">keysU</span></a><span class="hs-special">,</span><span>
</span><a name="line-110"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#elemsU"><span class="hs-identifier hs-var">elemsU</span></a><span class="hs-special">,</span><span>
</span><a name="line-111"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#assocsU"><span class="hs-identifier hs-var">assocsU</span></a><span class="hs-special">,</span><span>
</span><a name="line-112"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#toListU"><span class="hs-identifier hs-var">toListU</span></a><span class="hs-special">,</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-comment">-- * Helper methods</span><span>
</span><a name="line-114"></a><span>  </span><a href="Data.PQueue.Prio.Max.html#seqSpine"><span class="hs-identifier hs-var">seqSpine</span></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>
</span><a name="line-118"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">empty</span><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Arrow</span><span>
</span><a name="line-120"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-121"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-122"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Traversable</span><span>
</span><a name="line-124"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span class="hs-keyword">import</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Prio</span><span class="hs-operator">.</span><span class="hs-identifier">Max</span><span class="hs-operator">.</span><span class="hs-identifier">Internals</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">filter</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">break</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">span</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">takeWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">take</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">drop</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">!!</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldr</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">foldl</span><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Data.PQueue.Prio.Min.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">PQueue</span><span class="hs-operator">.</span><span class="hs-identifier">Prio</span><span class="hs-operator">.</span><span class="hs-identifier">Min</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Q</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-132"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">build</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Lexeme</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Ident</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">lexP</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">parens</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">prec</span><span class="hs-special">,</span><span>
</span><a name="line-134"></a><span>  </span><span class="hs-identifier hs-var">readPrec</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readListPrec</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">readListPrecDefault</span><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span><span>
</span><a name="line-136"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-137"></a><span class="hs-identifier">build</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">a</span><span class="hs-special">]</span><span>
</span><a name="line-138"></a><span class="hs-identifier">build</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">f</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-139"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-140"></a><span>
</span><a name="line-141"></a><span class="hs-identifier">first'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450250"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450251"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450250"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450252"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450251"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450252"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><a name="first%27"><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier">first'</span></a></a><span> </span><a name="local-1627450253"><a href="#local-1627450253"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a name="local-1627450254"><a href="#local-1627450254"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450255"><a href="#local-1627450255"><span class="hs-identifier">c</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627450253"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450254"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450255"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450363"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450363"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450364"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-145"></a><span>  </span><a name="local-805306882"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#empty"><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-146"></a><span>  </span><a name="local-805306883"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#union"><span class="hs-identifier hs-var">union</span></a><span>
</span><a name="line-147"></a><span>  </span><a name="local-805306884"><span class="hs-identifier">mconcat</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#unions"><span class="hs-identifier hs-var">unions</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450359"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-1627450359"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-1627450360"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450359"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450360"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-150"></a><span>  </span><a name="local-1912608631"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-1627450361"><a href="#local-1627450361"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-1627450362"><a href="#local-1627450362"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">showParen</span><span> </span><span class="hs-special">(</span><a href="#local-1627450361"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span>
</span><a name="line-151"></a><span>    </span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;fromDescList &quot;</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">shows</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span> </span><a href="#local-1627450362"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-1627450356"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-1627450357"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450356"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450357"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-154"></a><span class="hs-cpp">#ifdef __GLASGOW_HASKELL__</span><span>
</span><a name="line-155"></a><span>  </span><a name="local-1912608343"><span class="hs-identifier">readPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">parens</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">prec</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-identifier hs-var">Ident</span><span> </span><span class="hs-string">&quot;fromDescList&quot;</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">lexP</span><span>
</span><a name="line-157"></a><span>    </span><a name="local-1627450358"><a href="#local-1627450358"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">readPrec</span><span>
</span><a name="line-158"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#fromDescList"><span class="hs-identifier hs-var">fromDescList</span></a><span> </span><a href="#local-1627450358"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>
</span><a name="line-160"></a><span>  </span><a name="local-1912608342"><span class="hs-identifier">readListPrec</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">readListPrecDefault</span><span>
</span><a name="line-161"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-162"></a><span>  </span><span class="hs-identifier">readsPrec</span><span> </span><span class="hs-identifier">p</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">readParen</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">p</span><span> </span><span class="hs-operator">&gt;</span><span> </span><span class="hs-number">10</span><span class="hs-special">)</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;fromDescList&quot;</span><span class="hs-special">,</span><span class="hs-identifier">s</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">lex</span><span> </span><span class="hs-identifier">r</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">reads</span><span> </span><span class="hs-identifier">s</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromDescList</span><span> </span><span class="hs-identifier">xs</span><span class="hs-special">,</span><span class="hs-identifier">t</span><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-167"></a><span>
</span><a name="line-168"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450353"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-169"></a><span>  </span><a name="local-805306541"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-1627450354"><a href="#local-1627450354"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450355"><a href="#local-1627450355"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-1627450354"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450355"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450346"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450346"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-172"></a><span>  </span><a name="local-1912607661"><span class="hs-identifier">foldr</span></a><span> </span><a name="local-1627450347"><a href="#local-1627450347"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627450348"><a href="#local-1627450348"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450349"><a href="#local-1627450349"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-1627450347"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450348"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627450349"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-173"></a><span>  </span><a name="local-1912607659"><span class="hs-identifier">foldl</span></a><span> </span><a name="local-1627450350"><a href="#local-1627450350"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627450351"><a href="#local-1627450351"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450352"><a href="#local-1627450352"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="#local-1627450350"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450351"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627450352"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450343"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450343"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-176"></a><span>  </span><a name="local-1912606085"><span class="hs-identifier">traverse</span></a><span> </span><a name="local-1627450344"><a href="#local-1627450344"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450345"><a href="#local-1627450345"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">traverse</span><span> </span><a href="#local-1627450344"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450345"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | /O(1)/.  Returns the empty priority queue.</span><span>
</span><a name="line-179"></a><span class="hs-identifier">empty</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450248"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450249"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-180"></a><a name="empty"><a href="Data.PQueue.Prio.Max.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="Data.PQueue.Prio.Internals.html#empty"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-comment">-- | /O(1)/.  Constructs a singleton priority queue.</span><span>
</span><a name="line-183"></a><span class="hs-identifier">singleton</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627450246"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450247"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450246"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450247"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-184"></a><a name="singleton"><a href="Data.PQueue.Prio.Max.html#singleton"><span class="hs-identifier">singleton</span></a></a><span> </span><a name="local-1627450256"><a href="#local-1627450256"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1627450257"><a href="#local-1627450257"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#singleton"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a href="#local-1627450256"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627450257"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>
</span><a name="line-186"></a><span class="hs-comment">-- | Amortized /O(1)/, worst-case /O(log n)/.  Inserts</span><span>
</span><a name="line-187"></a><span class="hs-comment">-- an element with the specified key into the queue.</span><span>
</span><a name="line-188"></a><span class="hs-identifier">insert</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450244"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-1627450244"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450245"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450244"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450245"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450244"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450245"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-189"></a><a name="insert"><a href="Data.PQueue.Prio.Max.html#insert"><span class="hs-identifier">insert</span></a></a><span> </span><a name="local-1627450258"><a href="#local-1627450258"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-1627450259"><a href="#local-1627450259"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450260"><a href="#local-1627450260"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#insert"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a href="#local-1627450258"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627450259"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-1627450260"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">-- | Amortized /O(log(min(n1, n2)))/, worst-case /O(log(max(n1, n2)))/.  Returns the union</span><span>
</span><a name="line-192"></a><span class="hs-comment">-- of the two specified queues.</span><span>
</span><a name="line-193"></a><span class="hs-identifier">union</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450242"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450242"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450243"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450242"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450243"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450242"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450243"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-194"></a><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450261"><a href="#local-1627450261"><span class="hs-identifier">q1</span></a></a><span> </span><span class="hs-special">`</span><a name="union"><a href="Data.PQueue.Prio.Max.html#union"><span class="hs-identifier">union</span></a></a><span class="hs-special">`</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450262"><a href="#local-1627450262"><span class="hs-identifier">q2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450261"><span class="hs-identifier hs-var">q1</span></a><span> </span><span class="hs-special">`</span><a href="Data.PQueue.Prio.Internals.html#union"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span></a><span class="hs-special">`</span><span> </span><a href="#local-1627450262"><span class="hs-identifier hs-var">q2</span></a><span class="hs-special">)</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-comment">-- | The union of a list of queues: (@'unions' == 'List.foldl' 'union' 'empty'@).</span><span>
</span><a name="line-197"></a><span class="hs-identifier">unions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450240"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450240"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450241"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450240"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450241"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-198"></a><a name="unions"><a href="Data.PQueue.Prio.Max.html#unions"><span class="hs-identifier">unions</span></a></a><span> </span><a name="local-1627450263"><a href="#local-1627450263"><span class="hs-identifier">qs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#unions"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unions</span></a><span> </span><span class="hs-special">[</span><a href="#local-1627450264"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450264"><a href="#local-1627450264"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-1627450263"><span class="hs-identifier hs-var">qs</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span class="hs-comment">-- | /O(1)/.  Checks if this priority queue is empty.</span><span>
</span><a name="line-201"></a><span class="hs-identifier">null</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450238"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450239"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-202"></a><a name="null"><a href="Data.PQueue.Prio.Max.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450265"><a href="#local-1627450265"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#null"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-1627450265"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-comment">-- | /O(1)/.  Returns the size of this priority queue.</span><span>
</span><a name="line-205"></a><span class="hs-identifier">size</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450236"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450237"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-206"></a><a name="size"><a href="Data.PQueue.Prio.Max.html#size"><span class="hs-identifier">size</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450266"><a href="#local-1627450266"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#size"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">size</span></a><span> </span><a href="#local-1627450266"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- | /O(1)/.  The maximal (key, element) in the queue.  Calls 'error' if empty.</span><span>
</span><a name="line-209"></a><span class="hs-identifier">findMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450234"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450235"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450234"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450235"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><a name="findMax"><a href="Data.PQueue.Prio.Max.html#findMax"><span class="hs-identifier">findMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error: findMax called on an empty queue&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.html#getMax"><span class="hs-identifier hs-var">getMax</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- | /O(1)/.  The maximal (key, element) in the queue, if the queue is nonempty.</span><span>
</span><a name="line-213"></a><span class="hs-identifier">getMax</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450232"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450233"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-1627450232"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450233"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><a name="getMax"><a href="Data.PQueue.Prio.Max.html#getMax"><span class="hs-identifier">getMax</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450267"><a href="#local-1627450267"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-215"></a><span>  </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a name="local-1627450268"><a href="#local-1627450268"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450269"><a href="#local-1627450269"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.PQueue.Prio.Internals.html#getMin"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">getMin</span></a><span> </span><a href="#local-1627450267"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-216"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-1627450268"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450269"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span class="hs-comment">-- | /O(log n)/.  Delete and find the element with the maximum key.  Calls 'error' if empty.</span><span>
</span><a name="line-219"></a><span class="hs-identifier">deleteMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450230"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450230"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450231"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450230"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450231"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-220"></a><a name="deleteMax"><a href="Data.PQueue.Prio.Max.html#deleteMax"><span class="hs-identifier">deleteMax</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450270"><a href="#local-1627450270"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#deleteMin"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">deleteMin</span></a><span> </span><a href="#local-1627450270"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-221"></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- | /O(log n)/.  Delete and find the element with the maximum key.  Calls 'error' if empty.</span><span>
</span><a name="line-223"></a><span class="hs-identifier">deleteFindMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450228"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450228"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450229"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627450228"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450229"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450228"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450229"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><a name="deleteFindMax"><a href="Data.PQueue.Prio.Max.html#deleteFindMax"><span class="hs-identifier">deleteFindMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Error: deleteFindMax called on an empty queue&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.html#maxViewWithKey"><span class="hs-identifier hs-var">maxViewWithKey</span></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- | /O(1)/.  Alter the value at the maximum key.  If the queue is empty, does nothing.</span><span>
</span><a name="line-227"></a><span class="hs-identifier">adjustMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450226"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450226"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450227"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450226"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450227"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450226"><span class="hs-identifier hs-type">a</span></a><span> </span><span>
</span><a name="line-228"></a><a name="adjustMax"><a href="Data.PQueue.Prio.Max.html#adjustMax"><span class="hs-identifier">adjustMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#adjustMaxWithKey"><span class="hs-identifier hs-var">adjustMaxWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- | /O(1)/.  Alter the value at the maximum key.  If the queue is empty, does nothing.</span><span>
</span><a name="line-231"></a><span class="hs-identifier">adjustMaxWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450224"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450225"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450225"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450224"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450225"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450224"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450225"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-232"></a><a name="adjustMaxWithKey"><a href="Data.PQueue.Prio.Max.html#adjustMaxWithKey"><span class="hs-identifier">adjustMaxWithKey</span></a></a><span> </span><a name="local-1627450271"><a href="#local-1627450271"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450272"><a href="#local-1627450272"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#adjustMinWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">adjustMinWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450271"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450272"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-comment">-- | /O(log n)/.  (Actually /O(1)/ if there's no deletion.)  Update the value at the maximum key.</span><span>
</span><a name="line-235"></a><span class="hs-comment">-- If the queue is empty, does nothing.</span><span>
</span><a name="line-236"></a><span class="hs-identifier">updateMax</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450222"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450223"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627450223"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450222"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450223"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450222"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450223"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-237"></a><a name="updateMax"><a href="Data.PQueue.Prio.Max.html#updateMax"><span class="hs-identifier">updateMax</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#updateMaxWithKey"><span class="hs-identifier hs-var">updateMaxWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-comment">-- | /O(log n)/.  (Actually /O(1)/ if there's no deletion.)  Update the value at the maximum key.</span><span>
</span><a name="line-240"></a><span class="hs-comment">-- If the queue is empty, does nothing.</span><span>
</span><a name="line-241"></a><span class="hs-identifier">updateMaxWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450220"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450220"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450221"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627450221"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450220"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450221"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450220"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450221"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-242"></a><a name="updateMaxWithKey"><a href="Data.PQueue.Prio.Max.html#updateMaxWithKey"><span class="hs-identifier">updateMaxWithKey</span></a></a><span> </span><a name="local-1627450273"><a href="#local-1627450273"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450274"><a href="#local-1627450274"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#updateMinWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">updateMinWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450273"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450274"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>
</span><a name="line-244"></a><span class="hs-comment">-- | /O(log n)/.  Retrieves the value associated with the maximum key of the queue, and the queue</span><span>
</span><a name="line-245"></a><span class="hs-comment">-- stripped of that element, or 'Nothing' if passed an empty queue.</span><span>
</span><a name="line-246"></a><span class="hs-identifier">maxView</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450218"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450218"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450219"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-1627450219"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450218"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450219"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><a name="maxView"><a href="Data.PQueue.Prio.Max.html#maxView"><span class="hs-identifier">maxView</span></a></a><span> </span><a name="local-1627450275"><a href="#local-1627450275"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-1627450276"><a href="#local-1627450276"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-1627450277"><a href="#local-1627450277"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.PQueue.Prio.Max.html#maxViewWithKey"><span class="hs-identifier hs-var">maxViewWithKey</span></a><span> </span><a href="#local-1627450275"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-249"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-1627450276"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450277"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-comment">-- | /O(log n)/.  Retrieves the maximal (key, value) pair of the map, and the map stripped of that</span><span>
</span><a name="line-252"></a><span class="hs-comment">-- element, or 'Nothing' if passed an empty map.</span><span>
</span><a name="line-253"></a><span class="hs-identifier">maxViewWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450216"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450216"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450217"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627450216"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450217"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450216"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450217"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-254"></a><a name="maxViewWithKey"><a href="Data.PQueue.Prio.Max.html#maxViewWithKey"><span class="hs-identifier">maxViewWithKey</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450278"><a href="#local-1627450278"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-255"></a><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span> </span><a name="local-1627450279"><a href="#local-1627450279"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450280"><a href="#local-1627450280"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a name="local-1627450281"><a href="#local-1627450281"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Data.PQueue.Prio.Internals.html#minViewWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">minViewWithKey</span></a><span> </span><a href="#local-1627450278"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-256"></a><span>  </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-1627450279"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450280"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450281"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span class="hs-comment">-- | /O(n)/.  Map a function over all values in the queue.</span><span>
</span><a name="line-259"></a><span class="hs-identifier">map</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450213"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450214"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450215"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450213"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450215"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450214"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-260"></a><a name="map"><a href="Data.PQueue.Prio.Max.html#map"><span class="hs-identifier">map</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#mapWithKey"><span class="hs-identifier hs-var">mapWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">-- | /O(n)/.  Map a function over all values in the queue.</span><span>
</span><a name="line-263"></a><span class="hs-identifier">mapWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450210"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450211"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450212"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450210"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450211"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450210"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450212"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-264"></a><a name="mapWithKey"><a href="Data.PQueue.Prio.Max.html#mapWithKey"><span class="hs-identifier">mapWithKey</span></a></a><span> </span><a name="local-1627450282"><a href="#local-1627450282"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450283"><a href="#local-1627450283"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#mapWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450282"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450283"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span class="hs-comment">-- | /O(n)/.  Map a function over all values in the queue.</span><span>
</span><a name="line-267"></a><span class="hs-identifier">mapKeys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450207"><span class="hs-identifier hs-type">k'</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450208"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450207"><span class="hs-identifier hs-type">k'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450208"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450209"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450207"><span class="hs-identifier hs-type">k'</span></a><span> </span><a href="#local-1627450209"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-268"></a><a name="mapKeys"><a href="Data.PQueue.Prio.Max.html#mapKeys"><span class="hs-identifier">mapKeys</span></a></a><span> </span><a name="local-1627450284"><a href="#local-1627450284"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450285"><a href="#local-1627450285"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#mapKeys"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapKeys</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-1627450284"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627450285"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-comment">-- | /O(n)/.  @'mapKeysMonotonic' f q == 'mapKeys' f q@, but only works when @f@ is strictly</span><span>
</span><a name="line-271"></a><span class="hs-comment">-- monotonic.  /The precondition is not checked./  This function has better performance than</span><span>
</span><a name="line-272"></a><span class="hs-comment">-- 'mapKeys'.</span><span>
</span><a name="line-273"></a><span class="hs-identifier">mapKeysMonotonic</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450204"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450205"><span class="hs-identifier hs-type">k'</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450204"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450206"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450205"><span class="hs-identifier hs-type">k'</span></a><span> </span><a href="#local-1627450206"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-274"></a><a name="mapKeysMonotonic"><a href="Data.PQueue.Prio.Max.html#mapKeysMonotonic"><span class="hs-identifier">mapKeysMonotonic</span></a></a><span> </span><a name="local-1627450286"><a href="#local-1627450286"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450287"><a href="#local-1627450287"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#mapKeysMonotonic"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapKeysMonotonic</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-1627450286"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627450287"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-275"></a><span>
</span><a name="line-276"></a><span class="hs-comment">-- | /O(n log n)/.  Fold the keys and values in the map, such that </span><span>
</span><a name="line-277"></a><span class="hs-comment">-- @'foldrWithKey' f z q == 'List.foldr' ('uncurry' f) z ('toAscList' q)@.</span><span>
</span><a name="line-278"></a><span class="hs-comment">-- </span><span>
</span><a name="line-279"></a><span class="hs-comment">-- If you do not care about the traversal order, consider using 'foldrWithKeyU'.</span><span>
</span><a name="line-280"></a><span class="hs-identifier">foldrWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450201"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450201"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450202"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450203"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450203"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450203"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450201"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450202"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450203"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-281"></a><a name="foldrWithKey"><a href="Data.PQueue.Prio.Max.html#foldrWithKey"><span class="hs-identifier">foldrWithKey</span></a></a><span> </span><a name="local-1627450288"><a href="#local-1627450288"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627450289"><a href="#local-1627450289"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450290"><a href="#local-1627450290"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#foldrWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450288"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450289"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627450290"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">-- | /O(n log n)/.  Fold the keys and values in the map, such that </span><span>
</span><a name="line-284"></a><span class="hs-comment">-- @'foldlWithKey' f z q == 'List.foldl' ('uncurry' . f) z ('toAscList' q)@.</span><span>
</span><a name="line-285"></a><span class="hs-comment">-- </span><span>
</span><a name="line-286"></a><span class="hs-comment">-- If you do not care about the traversal order, consider using 'foldlWithKeyU'.</span><span>
</span><a name="line-287"></a><span class="hs-identifier">foldlWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450198"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450199"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450198"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450200"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450199"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450199"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450198"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450200"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450199"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-288"></a><a name="foldlWithKey"><a href="Data.PQueue.Prio.Max.html#foldlWithKey"><span class="hs-identifier">foldlWithKey</span></a></a><span> </span><a name="local-1627450291"><a href="#local-1627450291"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627450292"><a href="#local-1627450292"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450293"><a href="#local-1627450293"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#foldlWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldlWithKey</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627450294"><a href="#local-1627450294"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450291"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450294"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450292"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627450293"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span class="hs-comment">-- | /O(n log n)/.  Traverses the elements of the queue in descending order by key.</span><span>
</span><a name="line-291"></a><span class="hs-comment">-- (@'traverseWithKey' f q == 'fromDescList' &lt;$&gt; 'traverse' ('uncurry' f) ('toDescList' q)@)</span><span>
</span><a name="line-292"></a><span class="hs-comment">-- </span><span>
</span><a name="line-293"></a><span class="hs-comment">-- If you do not care about the /order/ of the traversal, consider using 'traverseWithKeyU'.</span><span>
</span><a name="line-294"></a><span class="hs-identifier">traverseWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450194"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-1627450195"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450194"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450196"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450195"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627450197"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450194"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450196"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450195"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450194"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450197"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-295"></a><a name="traverseWithKey"><a href="Data.PQueue.Prio.Max.html#traverseWithKey"><span class="hs-identifier">traverseWithKey</span></a></a><span> </span><a name="local-1627450295"><a href="#local-1627450295"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450296"><a href="#local-1627450296"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.PQueue.Prio.Min.html#traverseWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">traverseWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450295"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450296"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-296"></a><span>
</span><a name="line-297"></a><span class="hs-comment">-- | /O(k log n)/.  Takes the first @k@ (key, value) pairs in the queue, or the first @n@ if @k &gt;= n@.</span><span>
</span><a name="line-298"></a><span class="hs-comment">-- (@'take' k q == 'List.take' k ('toDescList' q)@)</span><span>
</span><a name="line-299"></a><span class="hs-identifier">take</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450192"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450192"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450193"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450192"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450193"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-300"></a><a name="take"><a href="Data.PQueue.Prio.Max.html#take"><span class="hs-identifier">take</span></a></a><span> </span><a name="local-1627450297"><a href="#local-1627450297"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450298"><a href="#local-1627450298"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#take"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">take</span></a><span> </span><a href="#local-1627450297"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627450298"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span class="hs-comment">-- | /O(k log n)/.  Deletes the first @k@ (key, value) pairs in the queue, or returns an empty queue if @k &gt;= n@.</span><span>
</span><a name="line-303"></a><span class="hs-identifier">drop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450190"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450190"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450191"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450190"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450191"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-304"></a><a name="drop"><a href="Data.PQueue.Prio.Max.html#drop"><span class="hs-identifier">drop</span></a></a><span> </span><a name="local-1627450299"><a href="#local-1627450299"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450300"><a href="#local-1627450300"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#drop"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">drop</span></a><span> </span><a href="#local-1627450299"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627450300"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>
</span><a name="line-306"></a><span class="hs-comment">-- | /O(k log n)/.  Equivalent to @('take' k q, 'drop' k q)@.</span><span>
</span><a name="line-307"></a><span class="hs-identifier">splitAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450188"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450188"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450189"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450188"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450189"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450188"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450189"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-308"></a><a name="splitAt"><a href="Data.PQueue.Prio.Max.html#splitAt"><span class="hs-identifier">splitAt</span></a></a><span> </span><a name="local-1627450301"><a href="#local-1627450301"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450302"><a href="#local-1627450302"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.PQueue.Prio.Min.html#splitAt"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">splitAt</span></a><span> </span><a href="#local-1627450301"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-1627450302"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-309"></a><span>  </span><span class="hs-special">(</span><a name="local-1627450303"><a href="#local-1627450303"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450304"><a href="#local-1627450304"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450303"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450304"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span class="hs-comment">-- | Takes the longest possible prefix of elements satisfying the predicate.</span><span>
</span><a name="line-312"></a><span class="hs-comment">-- (@'takeWhile' p q == 'List.takeWhile' (p . 'snd') ('toAscList' q)@)</span><span>
</span><a name="line-313"></a><span class="hs-identifier">takeWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450186"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450187"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450186"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450187"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450186"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450187"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-314"></a><a name="takeWhile"><a href="Data.PQueue.Prio.Max.html#takeWhile"><span class="hs-identifier">takeWhile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#takeWhileWithKey"><span class="hs-identifier hs-var">takeWhileWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-315"></a><span>
</span><a name="line-316"></a><span class="hs-comment">-- | Takes the longest possible prefix of elements satisfying the predicate.</span><span>
</span><a name="line-317"></a><span class="hs-comment">-- (@'takeWhile' p q == 'List.takeWhile' (uncurry p) ('toAscList' q)@)</span><span>
</span><a name="line-318"></a><span class="hs-identifier">takeWhileWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450184"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450184"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450185"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450184"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450185"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450184"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450185"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-319"></a><a name="takeWhileWithKey"><a href="Data.PQueue.Prio.Max.html#takeWhileWithKey"><span class="hs-identifier">takeWhileWithKey</span></a></a><span> </span><a name="local-1627450305"><a href="#local-1627450305"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450306"><a href="#local-1627450306"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#takeWhileWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">takeWhileWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450305"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450306"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-comment">-- | Removes the longest possible prefix of elements satisfying the predicate.</span><span>
</span><a name="line-322"></a><span class="hs-identifier">dropWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450182"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450182"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450182"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450183"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-323"></a><a name="dropWhile"><a href="Data.PQueue.Prio.Max.html#dropWhile"><span class="hs-identifier">dropWhile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#dropWhileWithKey"><span class="hs-identifier hs-var">dropWhileWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-324"></a><span>
</span><a name="line-325"></a><span class="hs-comment">-- | Removes the longest possible prefix of elements satisfying the predicate.</span><span>
</span><a name="line-326"></a><span class="hs-identifier">dropWhileWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450180"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450180"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450181"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450180"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450181"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450180"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450181"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-327"></a><a name="dropWhileWithKey"><a href="Data.PQueue.Prio.Max.html#dropWhileWithKey"><span class="hs-identifier">dropWhileWithKey</span></a></a><span> </span><a name="local-1627450307"><a href="#local-1627450307"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450308"><a href="#local-1627450308"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#dropWhileWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">dropWhileWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450307"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450308"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span class="hs-comment">-- | Equivalent to @('takeWhile' p q, 'dropWhile' p q)@.</span><span>
</span><a name="line-330"></a><span class="hs-identifier">span</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450178"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450179"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450178"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450179"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450178"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450179"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450178"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450179"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-331"></a><a name="span"><a href="Data.PQueue.Prio.Max.html#span"><span class="hs-identifier">span</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#spanWithKey"><span class="hs-identifier hs-var">spanWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-comment">-- | Equivalent to @'span' ('not' . p)@.</span><span>
</span><a name="line-334"></a><span class="hs-identifier">break</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450176"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450177"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450176"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450177"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450176"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450177"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450176"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450177"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-335"></a><a name="break"><a href="Data.PQueue.Prio.Max.html#break"><span class="hs-identifier">break</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#breakWithKey"><span class="hs-identifier hs-var">breakWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-comment">-- | Equivalent to @'spanWithKey' (\ k a -&gt; 'not' (p k a)) q@.</span><span>
</span><a name="line-338"></a><span class="hs-identifier">spanWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450174"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450174"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450175"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450174"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450175"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450174"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450175"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450174"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450175"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-339"></a><a name="spanWithKey"><a href="Data.PQueue.Prio.Max.html#spanWithKey"><span class="hs-identifier">spanWithKey</span></a></a><span> </span><a name="local-1627450309"><a href="#local-1627450309"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450310"><a href="#local-1627450310"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.PQueue.Prio.Min.html#spanWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">spanWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450309"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450310"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-340"></a><span>  </span><span class="hs-special">(</span><a name="local-1627450311"><a href="#local-1627450311"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450312"><a href="#local-1627450312"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450311"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450312"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">-- | Equivalent to @'spanWithKey' (\ k a -&gt; 'not' (p k a)) q@.</span><span>
</span><a name="line-343"></a><span class="hs-identifier">breakWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450172"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450172"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450173"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450172"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450173"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450172"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450173"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450172"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450173"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-344"></a><a name="breakWithKey"><a href="Data.PQueue.Prio.Max.html#breakWithKey"><span class="hs-identifier">breakWithKey</span></a></a><span> </span><a name="local-1627450313"><a href="#local-1627450313"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450314"><a href="#local-1627450314"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.PQueue.Prio.Min.html#breakWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">breakWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450313"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450314"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-345"></a><span>  </span><span class="hs-special">(</span><a name="local-1627450315"><a href="#local-1627450315"><span class="hs-identifier">xs</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450316"><a href="#local-1627450316"><span class="hs-identifier">q'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450315"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450316"><span class="hs-identifier hs-var">q'</span></a><span class="hs-special">)</span><span>
</span><a name="line-346"></a><span>
</span><a name="line-347"></a><span class="hs-comment">-- | /O(n)/.  Filter all values that satisfy the predicate.</span><span>
</span><a name="line-348"></a><span class="hs-identifier">filter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450170"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450170"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450171"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450170"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450171"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-349"></a><a name="filter"><a href="Data.PQueue.Prio.Max.html#filter"><span class="hs-identifier">filter</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#filterWithKey"><span class="hs-identifier hs-var">filterWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-comment">-- | /O(n)/.  Filter all values that satisfy the predicate.</span><span>
</span><a name="line-352"></a><span class="hs-identifier">filterWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450168"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450168"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450169"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450168"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450169"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450168"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450169"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-353"></a><a name="filterWithKey"><a href="Data.PQueue.Prio.Max.html#filterWithKey"><span class="hs-identifier">filterWithKey</span></a></a><span> </span><a name="local-1627450317"><a href="#local-1627450317"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450318"><a href="#local-1627450318"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#filterWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">filterWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450317"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450318"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>
</span><a name="line-355"></a><span class="hs-comment">-- | /O(n)/.  Partition the queue according to a predicate.  The first queue contains all elements</span><span>
</span><a name="line-356"></a><span class="hs-comment">-- which satisfy the predicate, the second all elements that fail the predicate.</span><span>
</span><a name="line-357"></a><span class="hs-identifier">partition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450166"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450167"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450166"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450167"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450166"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450167"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450166"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450167"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-358"></a><a name="partition"><a href="Data.PQueue.Prio.Max.html#partition"><span class="hs-identifier">partition</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#partitionWithKey"><span class="hs-identifier hs-var">partitionWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-comment">-- | /O(n)/.  Partition the queue according to a predicate.  The first queue contains all elements</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- which satisfy the predicate, the second all elements that fail the predicate.</span><span>
</span><a name="line-362"></a><span class="hs-identifier">partitionWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450164"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450164"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450164"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450165"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450164"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450165"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450164"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450165"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-363"></a><a name="partitionWithKey"><a href="Data.PQueue.Prio.Max.html#partitionWithKey"><span class="hs-identifier">partitionWithKey</span></a></a><span> </span><a name="local-1627450319"><a href="#local-1627450319"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450320"><a href="#local-1627450320"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.PQueue.Prio.Min.html#partitionWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">partitionWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450319"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450320"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-364"></a><span>  </span><span class="hs-special">(</span><a name="local-1627450321"><a href="#local-1627450321"><span class="hs-identifier">q1</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450322"><a href="#local-1627450322"><span class="hs-identifier">q0</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450321"><span class="hs-identifier hs-var">q1</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450322"><span class="hs-identifier hs-var">q0</span></a><span class="hs-special">)</span><span>
</span><a name="line-365"></a><span>
</span><a name="line-366"></a><span class="hs-comment">-- | /O(n)/.  Map values and collect the 'Just' results.</span><span>
</span><a name="line-367"></a><span class="hs-identifier">mapMaybe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450161"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450162"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627450163"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450161"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450162"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450161"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450163"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-368"></a><a name="mapMaybe"><a href="Data.PQueue.Prio.Max.html#mapMaybe"><span class="hs-identifier">mapMaybe</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#mapMaybeWithKey"><span class="hs-identifier hs-var">mapMaybeWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-comment">-- | /O(n)/.  Map values and collect the 'Just' results.</span><span>
</span><a name="line-371"></a><span class="hs-identifier">mapMaybeWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450158"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450158"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627450160"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450158"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450158"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450160"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-372"></a><a name="mapMaybeWithKey"><a href="Data.PQueue.Prio.Max.html#mapMaybeWithKey"><span class="hs-identifier">mapMaybeWithKey</span></a></a><span> </span><a name="local-1627450323"><a href="#local-1627450323"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450324"><a href="#local-1627450324"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Internals.html#mapMaybeWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapMaybeWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450323"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450324"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-373"></a><span>
</span><a name="line-374"></a><span class="hs-comment">-- | /O(n)/.  Map values and separate the 'Left' and 'Right' results.</span><span>
</span><a name="line-375"></a><span class="hs-identifier">mapEither</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450154"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450155"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-1627450156"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627450157"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450154"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450155"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450154"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450156"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450154"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450157"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><a name="mapEither"><a href="Data.PQueue.Prio.Max.html#mapEither"><span class="hs-identifier">mapEither</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#mapEitherWithKey"><span class="hs-identifier hs-var">mapEitherWithKey</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-377"></a><span>
</span><a name="line-378"></a><span class="hs-comment">-- | /O(n)/.  Map values and separate the 'Left' and 'Right' results.</span><span>
</span><a name="line-379"></a><span class="hs-identifier">mapEitherWithKey</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450150"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450150"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450151"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-1627450152"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-1627450153"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450150"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450151"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450150"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450152"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450150"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450153"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-380"></a><a name="mapEitherWithKey"><a href="Data.PQueue.Prio.Max.html#mapEitherWithKey"><span class="hs-identifier">mapEitherWithKey</span></a></a><span> </span><a name="local-1627450325"><a href="#local-1627450325"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450326"><a href="#local-1627450326"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Data.PQueue.Prio.Internals.html#mapEitherWithKey"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapEitherWithKey</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450325"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450326"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-381"></a><span>  </span><span class="hs-special">(</span><a name="local-1627450327"><a href="#local-1627450327"><span class="hs-identifier">qL</span></a></a><span class="hs-special">,</span><span> </span><a name="local-1627450328"><a href="#local-1627450328"><span class="hs-identifier">qR</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450327"><span class="hs-identifier hs-var">qL</span></a><span class="hs-special">,</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a href="#local-1627450328"><span class="hs-identifier hs-var">qR</span></a><span class="hs-special">)</span><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span class="hs-comment">-- | /O(n)/.  Build a priority queue from the list of (key, value) pairs.</span><span>
</span><a name="line-384"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450148"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450148"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450149"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450148"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450149"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-385"></a><a name="fromList"><a href="Data.PQueue.Prio.Max.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Min.html#fromList"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-comment">-- | /O(n)/.  Build a priority queue from an ascending list of (key, value) pairs.  /The precondition is not checked./</span><span>
</span><a name="line-388"></a><span class="hs-identifier">fromAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450146"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450147"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450146"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450147"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-389"></a><a name="fromAscList"><a href="Data.PQueue.Prio.Max.html#fromAscList"><span class="hs-identifier">fromAscList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Min.html#fromDescList"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromDescList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span class="hs-special">)</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span class="hs-comment">-- | /O(n)/.  Build a priority queue from a descending list of (key, value) pairs.  /The precondition is not checked./</span><span>
</span><a name="line-392"></a><span class="hs-identifier">fromDescList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450144"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450145"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450144"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450145"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-393"></a><a name="fromDescList"><a href="Data.PQueue.Prio.Max.html#fromDescList"><span class="hs-identifier">fromDescList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Min.html#fromAscList"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromAscList</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#Down"><span class="hs-identifier hs-var">Down</span></a><span class="hs-special">)</span><span>
</span><a name="line-394"></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- | /O(n log n)/.  Return all keys of the queue in ascending order.</span><span>
</span><a name="line-396"></a><span class="hs-identifier">keys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450142"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450142"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450143"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627450142"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-397"></a><a name="keys"><a href="Data.PQueue.Prio.Max.html#keys"><span class="hs-identifier">keys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span>
</span><a name="line-398"></a><span>
</span><a name="line-399"></a><span class="hs-comment">-- | /O(n log n)/.  Return all elements of the queue in ascending order by key.</span><span>
</span><a name="line-400"></a><span class="hs-identifier">elems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450140"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450140"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450141"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627450141"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-401"></a><a name="elems"><a href="Data.PQueue.Prio.Max.html#elems"><span class="hs-identifier">elems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-comment">-- | /O(n log n)/.  Equivalent to 'toDescList'.</span><span>
</span><a name="line-404"></a><span class="hs-identifier">assocs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450138"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450138"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450139"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450138"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450139"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-405"></a><a name="assocs"><a href="Data.PQueue.Prio.Max.html#assocs"><span class="hs-identifier">assocs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span>
</span><a name="line-406"></a><span>
</span><a name="line-407"></a><span class="hs-comment">-- | /O(n log n)/.  Return all (key, value) pairs in ascending order by key.</span><span>
</span><a name="line-408"></a><span class="hs-identifier">toAscList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450136"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450136"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450137"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450136"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450137"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-409"></a><a name="toAscList"><a href="Data.PQueue.Prio.Max.html#toAscList"><span class="hs-identifier">toAscList</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450329"><a href="#local-1627450329"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#toDescList"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toDescList</span></a><span> </span><a href="#local-1627450329"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span class="hs-comment">-- | /O(n log n)/.  Return all (key, value) pairs in descending order by key.</span><span>
</span><a name="line-412"></a><span class="hs-identifier">toDescList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450134"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450134"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450135"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450134"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450135"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-413"></a><a name="toDescList"><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier">toDescList</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450330"><a href="#local-1627450330"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#toAscList"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toAscList</span></a><span> </span><a href="#local-1627450330"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-comment">-- | /O(n log n)/.  Equivalent to 'toAscList'.</span><span>
</span><a name="line-416"></a><span class="hs-comment">-- </span><span>
</span><a name="line-417"></a><span class="hs-comment">-- If the traversal order is irrelevant, consider using 'toListU'.</span><span>
</span><a name="line-418"></a><span class="hs-identifier">toList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-1627450132"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450132"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450133"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450132"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450133"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-419"></a><a name="toList"><a href="Data.PQueue.Prio.Max.html#toList"><span class="hs-identifier">toList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#toDescList"><span class="hs-identifier hs-var">toDescList</span></a><span>
</span><a name="line-420"></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- | /O(n)/.  An unordered right fold over the elements of the queue, in no particular order.</span><span>
</span><a name="line-422"></a><span class="hs-identifier">foldrU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450130"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450130"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450130"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450131"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450130"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-423"></a><a name="foldrU"><a href="Data.PQueue.Prio.Max.html#foldrU"><span class="hs-identifier">foldrU</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#foldrWithKeyU"><span class="hs-identifier hs-var">foldrWithKeyU</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-424"></a><span>
</span><a name="line-425"></a><span class="hs-comment">-- | /O(n)/.  An unordered right fold over the elements of the queue, in no particular order.</span><span>
</span><a name="line-426"></a><span class="hs-identifier">foldrWithKeyU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450126"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450128"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450128"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450128"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450126"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450128"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-427"></a><a name="foldrWithKeyU"><a href="Data.PQueue.Prio.Max.html#foldrWithKeyU"><span class="hs-identifier">foldrWithKeyU</span></a></a><span> </span><a name="local-1627450331"><a href="#local-1627450331"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627450332"><a href="#local-1627450332"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450333"><a href="#local-1627450333"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#foldrWithKeyU"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldrWithKeyU</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450331"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450332"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627450333"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span class="hs-comment">-- | /O(n)/.  An unordered left fold over the elements of the queue, in no particular order.</span><span>
</span><a name="line-430"></a><span class="hs-identifier">foldlU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450123"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450123"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450123"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450125"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450123"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-431"></a><a name="foldlU"><a href="Data.PQueue.Prio.Max.html#foldlU"><span class="hs-identifier">foldlU</span></a></a><span> </span><a name="local-1627450334"><a href="#local-1627450334"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#foldlWithKeyU"><span class="hs-identifier hs-var">foldlWithKeyU</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-1627450334"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-432"></a><span>
</span><a name="line-433"></a><span class="hs-comment">-- | /O(n)/.  An unordered left fold over the elements of the queue, in no particular order.</span><span>
</span><a name="line-434"></a><span class="hs-identifier">foldlWithKeyU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-1627450120"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450121"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450120"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450120"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450121"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450120"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-435"></a><a name="foldlWithKeyU"><a href="Data.PQueue.Prio.Max.html#foldlWithKeyU"><span class="hs-identifier">foldlWithKeyU</span></a></a><span> </span><a name="local-1627450335"><a href="#local-1627450335"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-1627450336"><a href="#local-1627450336"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450337"><a href="#local-1627450337"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#foldlWithKeyU"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldlWithKeyU</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a name="local-1627450338"><a href="#local-1627450338"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450335"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-1627450338"><span class="hs-identifier hs-var">z</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450336"><span class="hs-identifier hs-var">z</span></a><span> </span><a href="#local-1627450337"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-comment">-- | /O(n)/.  An unordered traversal over a priority queue, in no particular order.</span><span>
</span><a name="line-438"></a><span class="hs-comment">-- While there is no guarantee in which order the elements are traversed, the resulting</span><span>
</span><a name="line-439"></a><span class="hs-comment">-- priority queue will be perfectly valid.</span><span>
</span><a name="line-440"></a><span class="hs-identifier">traverseU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-1627450116"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450117"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450116"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627450118"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450119"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450117"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450116"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450119"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450118"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-441"></a><a name="traverseU"><a href="Data.PQueue.Prio.Max.html#traverseU"><span class="hs-identifier">traverseU</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#traverseWithKeyU"><span class="hs-identifier hs-var">traverseWithKeyU</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-442"></a><span>
</span><a name="line-443"></a><span class="hs-comment">-- | /O(n)/.  An unordered traversal over a priority queue, in no particular order.</span><span>
</span><a name="line-444"></a><span class="hs-comment">-- While there is no guarantee in which order the elements are traversed, the resulting</span><span>
</span><a name="line-445"></a><span class="hs-comment">-- priority queue will be perfectly valid.</span><span>
</span><a name="line-446"></a><span class="hs-identifier">traverseWithKeyU</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-1627450112"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-1627450113"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450112"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-1627450115"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450113"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450112"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450113"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450115"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-447"></a><a name="traverseWithKeyU"><a href="Data.PQueue.Prio.Max.html#traverseWithKeyU"><span class="hs-identifier">traverseWithKeyU</span></a></a><span> </span><a name="local-1627450339"><a href="#local-1627450339"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450340"><a href="#local-1627450340"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Data.PQueue.Prio.Internals.html#traverseWithKeyU"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">traverseWithKeyU</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627450339"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><a href="#local-1627450340"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-448"></a><span>
</span><a name="line-449"></a><span class="hs-comment">-- | /O(n)/.  Return all keys of the queue in no particular order.</span><span>
</span><a name="line-450"></a><span class="hs-identifier">keysU</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450110"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450111"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627450110"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-451"></a><a name="keysU"><a href="Data.PQueue.Prio.Max.html#keysU"><span class="hs-identifier">keysU</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.html#toListU"><span class="hs-identifier hs-var">toListU</span></a><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span class="hs-comment">-- | /O(n)/.  Return all elements of the queue in no particular order.</span><span>
</span><a name="line-454"></a><span class="hs-identifier">elemsU</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450108"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450109"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-1627450109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-455"></a><a name="elemsU"><a href="Data.PQueue.Prio.Max.html#elemsU"><span class="hs-identifier">elemsU</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.PQueue.Prio.Max.html#toListU"><span class="hs-identifier hs-var">toListU</span></a><span>
</span><a name="line-456"></a><span>
</span><a name="line-457"></a><span class="hs-comment">-- | /O(n)/.  Equivalent to 'toListU'.</span><span>
</span><a name="line-458"></a><span class="hs-identifier">assocsU</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450106"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450107"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450106"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450107"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-459"></a><a name="assocsU"><a href="Data.PQueue.Prio.Max.html#assocsU"><span class="hs-identifier">assocsU</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Max.html#toListU"><span class="hs-identifier hs-var">toListU</span></a><span>
</span><a name="line-460"></a><span>
</span><a name="line-461"></a><span class="hs-comment">-- | /O(n)/.  Returns all (key, value) pairs in the queue in no particular order.</span><span>
</span><a name="line-462"></a><span class="hs-identifier">toListU</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450104"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-1627450104"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-1627450105"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-463"></a><a name="toListU"><a href="Data.PQueue.Prio.Max.html#toListU"><span class="hs-identifier">toListU</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450341"><a href="#local-1627450341"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.html#first%27"><span class="hs-identifier hs-var">first'</span></a><span> </span><span class="hs-identifier">unDown</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Min.html#toListU"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toListU</span></a><span> </span><a href="#local-1627450341"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span class="hs-comment">-- | /O(log n)/.  Analogous to @deepseq@ in the @deepseq@ package, but only forces the spine of the binomial heap.</span><span>
</span><a name="line-466"></a><span class="hs-identifier">seqSpine</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQueue"><span class="hs-identifier hs-type">MaxPQueue</span></a><span> </span><a href="#local-1627450101"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-1627450102"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450103"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627450103"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-467"></a><a name="seqSpine"><a href="Data.PQueue.Prio.Max.html#seqSpine"><span class="hs-identifier">seqSpine</span></a></a><span> </span><span class="hs-special">(</span><a href="Data.PQueue.Prio.Max.Internals.html#MaxPQ"><span class="hs-identifier hs-var">MaxPQ</span></a><span> </span><a name="local-1627450342"><a href="#local-1627450342"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.PQueue.Prio.Internals.html#seqSpine"><span class="hs-identifier hs-var">Q</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">seqSpine</span></a><span> </span><a href="#local-1627450342"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-468"></a></pre></body></html>