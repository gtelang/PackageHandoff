<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-----------------------------------------------------------------------------
    reactive-banana
------------------------------------------------------------------------------}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification, NamedFieldPuns #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances, FlexibleInstances #-}</span><span>
</span><a name="line-6"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Reactive</span><span class="hs-operator">.</span><span class="hs-identifier">Banana</span><span class="hs-operator">.</span><span class="hs-identifier">Prim</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span>           </span><a href="Control.Monad.Trans.RWSIO.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">RWSIO</span></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Reader</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><a href="Control.Monad.Trans.ReaderWriterIO.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">ReaderWriterIO</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Functor</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Hashable</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vault</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Lazy</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Mem</span><span class="hs-operator">.</span><span class="hs-identifier">Weak</span><span>
</span><a name="line-17"></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Reactive.Banana.Prim.Graph.html"><span class="hs-identifier">Reactive</span><span class="hs-operator">.</span><span class="hs-identifier">Banana</span><span class="hs-operator">.</span><span class="hs-identifier">Prim</span><span class="hs-operator">.</span><span class="hs-identifier">Graph</span></a><span>            </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span class="hs-special">)</span><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><a href="Reactive.Banana.Prim.OrderedBag.html"><span class="hs-identifier">Reactive</span><span class="hs-operator">.</span><span class="hs-identifier">Banana</span><span class="hs-operator">.</span><span class="hs-identifier">Prim</span><span class="hs-operator">.</span><span class="hs-identifier">OrderedBag</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">OB</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.OrderedBag.html#OrderedBag"><span class="hs-identifier hs-type">OrderedBag</span></a><span class="hs-special">,</span><span> </span><a href="Reactive.Banana.Prim.OrderedBag.html#empty"><span class="hs-identifier hs-var">empty</span></a><span class="hs-special">)</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><a href="Reactive.Banana.Prim.Util.html"><span class="hs-identifier">Reactive</span><span class="hs-operator">.</span><span class="hs-identifier">Banana</span><span class="hs-operator">.</span><span class="hs-identifier">Prim</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span></a><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-comment">{-----------------------------------------------------------------------------
    Network
------------------------------------------------------------------------------}</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- | A 'Network' represents the state of a pulse/latch network,</span><span>
</span><a name="line-26"></a><span class="hs-keyword">data</span><span> </span><a name="Network"><a href="Reactive.Banana.Prim.Types.html#Network"><span class="hs-identifier">Network</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Network"><a href="Reactive.Banana.Prim.Types.html#Network"><span class="hs-identifier">Network</span></a></a><span>
</span><a name="line-27"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="nTime"><a href="Reactive.Banana.Prim.Types.html#nTime"><span class="hs-identifier">nTime</span></a></a><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span>                 </span><span class="hs-comment">-- Current time.</span><span>
</span><a name="line-28"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="nOutputs"><a href="Reactive.Banana.Prim.Types.html#nOutputs"><span class="hs-identifier">nOutputs</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.OrderedBag.html#OrderedBag"><span class="hs-identifier hs-type">OrderedBag</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier hs-type">Output</span></a><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- Remember outputs to prevent garbage collection.</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="nAlwaysP"><a href="Reactive.Banana.Prim.Types.html#nAlwaysP"><span class="hs-identifier">nAlwaysP</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Pulse"><span class="hs-identifier hs-type">Pulse</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- Pulse that always fires.</span><span>
</span><a name="line-30"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">type</span><span> </span><a name="Inputs"><a href="Reactive.Banana.Prim.Types.html#Inputs"><span class="hs-identifier">Inputs</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Lazy</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Vault</span><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span class="hs-keyword">type</span><span> </span><a name="EvalNetwork"><a href="Reactive.Banana.Prim.Types.html#EvalNetwork"><span class="hs-identifier">EvalNetwork</span></a></a><span> </span><a name="local-1627439218"><a href="#local-1627439218"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Network"><span class="hs-identifier hs-type">Network</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="#local-1627439218"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Network"><span class="hs-identifier hs-type">Network</span></a><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">type</span><span> </span><a name="Step"><a href="Reactive.Banana.Prim.Types.html#Step"><span class="hs-identifier">Step</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalNetwork"><span class="hs-identifier hs-type">EvalNetwork</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><a name="emptyNetwork"><a href="Reactive.Banana.Prim.Types.html#emptyNetwork"><span class="hs-identifier">emptyNetwork</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Network"><span class="hs-identifier hs-var">Network</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">nTime</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#next"><span class="hs-identifier hs-var">next</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#beginning"><span class="hs-identifier hs-var">beginning</span></a><span>
</span><a name="line-38"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nOutputs</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.OrderedBag.html#empty"><span class="hs-identifier hs-var">OB</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">nAlwaysP</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-keyword">type</span><span> </span><a name="Build"><a href="Reactive.Banana.Prim.Types.html#Build"><span class="hs-identifier">Build</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.ReaderWriterIO.html#ReaderWriterIOT"><span class="hs-identifier hs-type">ReaderWriterIOT</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#BuildR"><span class="hs-identifier hs-type">BuildR</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-type">BuildW</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span>
</span><a name="line-43"></a><span class="hs-keyword">type</span><span> </span><a name="BuildR"><a href="Reactive.Banana.Prim.Types.html#BuildR"><span class="hs-identifier">BuildR</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span class="hs-special">,</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Pulse"><span class="hs-identifier hs-type">Pulse</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-comment">-- ( current time</span><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- , pulse that always fires)</span><span>
</span><a name="line-46"></a><span class="hs-keyword">newtype</span><span> </span><a name="BuildW"><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier">BuildW</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="BuildW"><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier">BuildW</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#DependencyBuilder"><span class="hs-identifier hs-type">DependencyBuilder</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier hs-type">Output</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-type">Action</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Build"><span class="hs-identifier hs-type">Build</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-comment">-- reader : current timestamp</span><span>
</span><a name="line-48"></a><span>    </span><span class="hs-comment">-- writer : ( actions that change the network topology</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-comment">--          , outputs to be added to the network</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-comment">--          , late IO actions</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-comment">--          , late build actions</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-comment">--          )</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-type">BuildW</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-55"></a><span>    </span><a name="local-805306882"><span class="hs-identifier">mempty</span></a><span>                          </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-var">BuildW</span></a><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-var">BuildW</span></a><span> </span><a name="local-1627439275"><a href="#local-1627439275"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a name="local-805306883"><span class="hs-identifier">mappend</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-var">BuildW</span></a><span> </span><a name="local-1627439276"><a href="#local-1627439276"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-var">BuildW</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627439275"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">mappend</span><span class="hs-special">`</span><span> </span><a href="#local-1627439276"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-keyword">type</span><span> </span><a name="BuildIO"><a href="Reactive.Banana.Prim.Types.html#BuildIO"><span class="hs-identifier">BuildIO</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Build"><span class="hs-identifier hs-type">Build</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-keyword">type</span><span> </span><a name="DependencyBuilder"><a href="Reactive.Banana.Prim.Types.html#DependencyBuilder"><span class="hs-identifier">DependencyBuilder</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Endo</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Graph.html#Graph"><span class="hs-identifier hs-type">Graph</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span class="hs-special">,</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{-----------------------------------------------------------------------------
    Synonyms
------------------------------------------------------------------------------}</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- | Priority used to determine evaluation order for pulses.</span><span>
</span><a name="line-66"></a><span class="hs-keyword">type</span><span> </span><a name="Level"><a href="Reactive.Banana.Prim.Types.html#Level"><span class="hs-identifier">Level</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-identifier">ground</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Level"><span class="hs-identifier hs-type">Level</span></a><span>
</span><a name="line-69"></a><a name="ground"><a href="Reactive.Banana.Prim.Types.html#ground"><span class="hs-identifier">ground</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-comment">-- | 'IO' actions as a monoid with respect to sequencing.</span><span>
</span><a name="line-72"></a><span class="hs-keyword">newtype</span><span> </span><a name="Action"><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier">Action</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Action"><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier">Action</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="doit"><a href="Reactive.Banana.Prim.Types.html#doit"><span class="hs-identifier">doit</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-73"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-type">Action</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-74"></a><span>    </span><a name="local-805306882"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-var">Action</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-var">Action</span></a><span> </span><a name="local-1627439273"><a href="#local-1627439273"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a name="local-805306883"><span class="hs-identifier">mappend</span></a><span class="hs-special">`</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-var">Action</span></a><span> </span><a name="local-1627439274"><a href="#local-1627439274"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-var">Action</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627439273"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-1627439274"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-comment">-- | Lens-like functionality.</span><span>
</span><a name="line-78"></a><span class="hs-keyword">data</span><span> </span><a name="Lens"><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier">Lens</span></a></a><span> </span><a name="local-1627439216"><a href="#local-1627439216"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-1627439217"><a href="#local-1627439217"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Lens"><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier">Lens</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-1627439216"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439217"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-1627439217"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439216"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439216"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-79"></a><a name="set"><a href="Reactive.Banana.Prim.Types.html#set"><span class="hs-identifier">set</span></a></a><span>    </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_</span><span>   </span><a name="local-1627439220"><a href="#local-1627439220"><span class="hs-identifier">set</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439220"><span class="hs-identifier hs-var">set</span></a><span>
</span><a name="line-80"></a><a name="update"><a href="Reactive.Banana.Prim.Types.html#update"><span class="hs-identifier">update</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><a name="local-1627439221"><a href="#local-1627439221"><span class="hs-identifier">get</span></a></a><span> </span><a name="local-1627439222"><a href="#local-1627439222"><span class="hs-identifier">set</span></a></a><span class="hs-special">)</span><span> </span><a name="local-1627439223"><a href="#local-1627439223"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-1627439224"><a href="#local-1627439224"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439222"><span class="hs-identifier hs-var">set</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627439223"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-1627439221"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="#local-1627439224"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-1627439224"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">{-----------------------------------------------------------------------------
    Pulse and Latch
------------------------------------------------------------------------------}</span><span>
</span><a name="line-85"></a><span class="hs-keyword">type</span><span> </span><a name="Pulse"><a href="Reactive.Banana.Prim.Types.html#Pulse"><span class="hs-identifier">Pulse</span></a></a><span>  </span><a name="local-1627439215"><a href="#local-1627439215"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#Ref"><span class="hs-identifier hs-type">Ref</span></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Pulse%27"><span class="hs-identifier hs-type">Pulse'</span></a><span> </span><a href="#local-1627439215"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span class="hs-keyword">data</span><span> </span><a name="Pulse%27"><a href="Reactive.Banana.Prim.Types.html#Pulse%27"><span class="hs-identifier">Pulse'</span></a></a><span> </span><a name="local-1627439214"><a href="#local-1627439214"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Pulse"><a href="Reactive.Banana.Prim.Types.html#Pulse"><span class="hs-identifier">Pulse</span></a></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_keyP"><a href="Reactive.Banana.Prim.Types.html#_keyP"><span class="hs-identifier">_keyP</span></a></a><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Lazy</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Key</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627439214"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Key to retrieve pulse from cache.</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_seenP"><a href="Reactive.Banana.Prim.Types.html#_seenP"><span class="hs-identifier">_seenP</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span>              </span><span class="hs-comment">-- See note [Timestamp].</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_evalP"><a href="Reactive.Banana.Prim.Types.html#_evalP"><span class="hs-identifier">_evalP</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalP"><span class="hs-identifier hs-type">EvalP</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-1627439214"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- Calculate current value.</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_childrenP"><a href="Reactive.Banana.Prim.Types.html#_childrenP"><span class="hs-identifier">_childrenP</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Weak</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- Weak references to child nodes.</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_parentsP"><a href="Reactive.Banana.Prim.Types.html#_parentsP"><span class="hs-identifier">_parentsP</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Weak</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span class="hs-special">]</span><span>    </span><span class="hs-comment">-- Weak reference to parent nodes.</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_levelP"><a href="Reactive.Banana.Prim.Types.html#_levelP"><span class="hs-identifier">_levelP</span></a></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Reactive.Banana.Prim.Types.html#Level"><span class="hs-identifier hs-type">Level</span></a><span>             </span><span class="hs-comment">-- Priority in evaluation order.</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_nameP"><a href="Reactive.Banana.Prim.Types.html#_nameP"><span class="hs-identifier">_nameP</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>             </span><span class="hs-comment">-- Name for debugging.</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Pulse"><span class="hs-identifier hs-type">Pulse</span></a><span> </span><a href="#local-1627439258"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-97"></a><span>    </span><a name="local-1912608630"><span class="hs-identifier">show</span></a><span> </span><a name="local-1627439259"><a href="#local-1627439259"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_nameP</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafePerformIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Reactive.Banana.Prim.Util.html#readRef"><span class="hs-identifier hs-var">readRef</span></a><span> </span><a href="#local-1627439259"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">hashWithSalt</span><span> </span><span class="hs-number">0</span><span> </span><a href="#local-1627439259"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">type</span><span> </span><a name="Latch"><a href="Reactive.Banana.Prim.Types.html#Latch"><span class="hs-identifier">Latch</span></a></a><span>  </span><a name="local-1627439213"><a href="#local-1627439213"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#Ref"><span class="hs-identifier hs-type">Ref</span></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Latch%27"><span class="hs-identifier hs-type">Latch'</span></a><span> </span><a href="#local-1627439213"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span class="hs-keyword">data</span><span> </span><a name="Latch%27"><a href="Reactive.Banana.Prim.Types.html#Latch%27"><span class="hs-identifier">Latch'</span></a></a><span> </span><a name="local-1627439212"><a href="#local-1627439212"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Latch"><a href="Reactive.Banana.Prim.Types.html#Latch"><span class="hs-identifier">Latch</span></a></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_seenL"><a href="Reactive.Banana.Prim.Types.html#_seenL"><span class="hs-identifier">_seenL</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span>               </span><span class="hs-comment">-- Timestamp for the current value.</span><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_valueL"><a href="Reactive.Banana.Prim.Types.html#_valueL"><span class="hs-identifier">_valueL</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-1627439212"><span class="hs-identifier hs-type">a</span></a><span>                   </span><span class="hs-comment">-- Current value.</span><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_evalL"><a href="Reactive.Banana.Prim.Types.html#_evalL"><span class="hs-identifier">_evalL</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalL"><span class="hs-identifier hs-type">EvalL</span></a><span> </span><a href="#local-1627439212"><span class="hs-identifier hs-type">a</span></a><span>             </span><span class="hs-comment">-- Recalculate current latch value.</span><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-105"></a><span class="hs-keyword">type</span><span> </span><a name="LatchWrite"><a href="Reactive.Banana.Prim.Types.html#LatchWrite"><span class="hs-identifier">LatchWrite</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#Ref"><span class="hs-identifier hs-type">Ref</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#LatchWrite%27"><span class="hs-identifier hs-type">LatchWrite'</span></a><span>
</span><a name="line-106"></a><span class="hs-keyword">data</span><span> </span><a name="LatchWrite%27"><a href="Reactive.Banana.Prim.Types.html#LatchWrite%27"><span class="hs-identifier">LatchWrite'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627439211"><a href="#local-1627439211"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a name="LatchWrite"><a href="Reactive.Banana.Prim.Types.html#LatchWrite"><span class="hs-identifier">LatchWrite</span></a></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_evalLW"><a href="Reactive.Banana.Prim.Types.html#_evalLW"><span class="hs-identifier">_evalLW</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalP"><span class="hs-identifier hs-type">EvalP</span></a><span> </span><a href="#local-1627439211"><span class="hs-identifier hs-type">a</span></a><span>            </span><span class="hs-comment">-- Calculate value to write.</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_latchLW"><a href="Reactive.Banana.Prim.Types.html#_latchLW"><span class="hs-identifier">_latchLW</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Weak</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Latch"><span class="hs-identifier hs-type">Latch</span></a><span> </span><a href="#local-1627439211"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- Destination 'Latch' to write to.</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-keyword">type</span><span> </span><a name="Output"><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier">Output</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#Ref"><span class="hs-identifier hs-type">Ref</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#Output%27"><span class="hs-identifier hs-type">Output'</span></a><span>
</span><a name="line-112"></a><span class="hs-keyword">data</span><span> </span><a name="Output%27"><a href="Reactive.Banana.Prim.Types.html#Output%27"><span class="hs-identifier">Output'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Output"><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier">Output</span></a></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_evalO"><a href="Reactive.Banana.Prim.Types.html#_evalO"><span class="hs-identifier">_evalO</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalP"><span class="hs-identifier hs-type">EvalP</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalO"><span class="hs-identifier hs-type">EvalO</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-115"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier hs-type">Output</span></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-805306535"><span class="hs-operator">==</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#equalRef"><span class="hs-identifier hs-var">equalRef</span></a><span>
</span><a name="line-116"></a><span>
</span><a name="line-117"></a><span class="hs-keyword">data</span><span> </span><a name="SomeNode"><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier">SomeNode</span></a></a><span>
</span><a name="line-118"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-1627439210"><a href="#local-1627439210"><span class="hs-identifier">a</span></a></a><span class="hs-operator">.</span><span> </span><a name="P"><a href="Reactive.Banana.Prim.Types.html#P"><span class="hs-identifier">P</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Pulse"><span class="hs-identifier hs-type">Pulse</span></a><span> </span><a href="#local-1627439210"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="L"><a href="Reactive.Banana.Prim.Types.html#L"><span class="hs-identifier">L</span></a></a><span> </span><a href="Reactive.Banana.Prim.Types.html#LatchWrite"><span class="hs-identifier hs-type">LatchWrite</span></a><span>
</span><a name="line-120"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="O"><a href="Reactive.Banana.Prim.Types.html#O"><span class="hs-identifier">O</span></a></a><span> </span><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier hs-type">Output</span></a><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Hashable</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-123"></a><span>    </span><a name="local-1912611449"><span class="hs-identifier">hashWithSalt</span></a><span> </span><a name="local-1627439252"><a href="#local-1627439252"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-1627439253"><a href="#local-1627439253"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hashWithSalt</span><span> </span><a href="#local-1627439252"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627439253"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-124"></a><span>    </span><span class="hs-identifier">hashWithSalt</span><span> </span><a name="local-1627439254"><a href="#local-1627439254"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1627439255"><a href="#local-1627439255"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hashWithSalt</span><span> </span><a href="#local-1627439254"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627439255"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier">hashWithSalt</span><span> </span><a name="local-1627439256"><a href="#local-1627439256"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-1627439257"><a href="#local-1627439257"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">hashWithSalt</span><span> </span><a href="#local-1627439256"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-1627439257"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-1627439246"><a href="#local-1627439246"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><a name="local-805306535"><span class="hs-operator">==</span></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-1627439247"><a href="#local-1627439247"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#equalRef"><span class="hs-identifier hs-var">equalRef</span></a><span> </span><a href="#local-1627439246"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627439247"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-129"></a><span>    </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1627439248"><a href="#local-1627439248"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1627439249"><a href="#local-1627439249"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#equalRef"><span class="hs-identifier hs-var">equalRef</span></a><span> </span><a href="#local-1627439248"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627439249"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-130"></a><span>    </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-1627439250"><a href="#local-1627439250"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-1627439251"><a href="#local-1627439251"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#equalRef"><span class="hs-identifier hs-var">equalRef</span></a><span> </span><a href="#local-1627439250"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627439251"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-pragma">{-# INLINE mkWeakNodeValue #-}</span><span>
</span><a name="line-133"></a><span class="hs-identifier">mkWeakNodeValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439219"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Weak</span><span> </span><a href="#local-1627439219"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-134"></a><a name="mkWeakNodeValue"><a href="Reactive.Banana.Prim.Types.html#mkWeakNodeValue"><span class="hs-identifier">mkWeakNodeValue</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-1627439225"><a href="#local-1627439225"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#mkWeakRefValue"><span class="hs-identifier hs-var">mkWeakRefValue</span></a><span> </span><a href="#local-1627439225"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-135"></a><span class="hs-identifier">mkWeakNodeValue</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1627439226"><a href="#local-1627439226"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#mkWeakRefValue"><span class="hs-identifier hs-var">mkWeakRefValue</span></a><span> </span><a href="#local-1627439226"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-136"></a><span class="hs-identifier">mkWeakNodeValue</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-1627439227"><a href="#local-1627439227"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Util.html#mkWeakRefValue"><span class="hs-identifier hs-var">mkWeakRefValue</span></a><span> </span><a href="#local-1627439227"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-137"></a><span>
</span><a name="line-138"></a><span class="hs-comment">-- Lenses for various parameters</span><span>
</span><a name="line-139"></a><a name="seenP"><a href="Reactive.Banana.Prim.Types.html#seenP"><span class="hs-identifier">seenP</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_seenP</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627439228"><a href="#local-1627439228"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627439229"><a href="#local-1627439229"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439229"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_seenP</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439228"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-140"></a><a name="seenL"><a href="Reactive.Banana.Prim.Types.html#seenL"><span class="hs-identifier">seenL</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_seenL</span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627439230"><a href="#local-1627439230"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627439231"><a href="#local-1627439231"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439231"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_seenL</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439230"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-141"></a><a name="valueL"><a href="Reactive.Banana.Prim.Types.html#valueL"><span class="hs-identifier">valueL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_valueL</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627439232"><a href="#local-1627439232"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627439233"><a href="#local-1627439233"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439233"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_valueL</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439232"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-142"></a><a name="parentsP"><a href="Reactive.Banana.Prim.Types.html#parentsP"><span class="hs-identifier">parentsP</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_parentsP</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627439234"><a href="#local-1627439234"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627439235"><a href="#local-1627439235"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439235"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_parentsP</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439234"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-143"></a><a name="childrenP"><a href="Reactive.Banana.Prim.Types.html#childrenP"><span class="hs-identifier">childrenP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_childrenP</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627439236"><a href="#local-1627439236"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627439237"><a href="#local-1627439237"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439237"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_childrenP</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439236"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-144"></a><a name="levelP"><a href="Reactive.Banana.Prim.Types.html#levelP"><span class="hs-identifier">levelP</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Lens"><span class="hs-identifier hs-var">Lens</span></a><span> </span><span class="hs-identifier">_levelP</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-1627439238"><a href="#local-1627439238"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-1627439239"><a href="#local-1627439239"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-1627439239"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_levelP</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-1627439238"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span>
</span><a name="line-146"></a><span class="hs-comment">-- | Evaluation monads.</span><span>
</span><a name="line-147"></a><span class="hs-keyword">type</span><span> </span><a name="EvalPW"><a href="Reactive.Banana.Prim.Types.html#EvalPW"><span class="hs-identifier">EvalPW</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#EvalLW"><span class="hs-identifier hs-type">EvalLW</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#Output"><span class="hs-identifier hs-type">Output</span></a><span class="hs-special">,</span><span> </span><a href="Reactive.Banana.Prim.Types.html#EvalO"><span class="hs-identifier hs-type">EvalO</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span class="hs-keyword">type</span><span> </span><a name="EvalLW"><a href="Reactive.Banana.Prim.Types.html#EvalLW"><span class="hs-identifier">EvalLW</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Action"><span class="hs-identifier hs-type">Action</span></a><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><span class="hs-keyword">type</span><span> </span><a name="EvalO"><a href="Reactive.Banana.Prim.Types.html#EvalO"><span class="hs-identifier">EvalO</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Future"><span class="hs-identifier hs-type">Future</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-keyword">type</span><span> </span><a name="Future"><a href="Reactive.Banana.Prim.Types.html#Future"><span class="hs-identifier">Future</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-type">IO</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- Note: For efficiency reasons, we unroll the monad transformer stack.</span><span>
</span><a name="line-154"></a><span class="hs-comment">-- type EvalP = RWST () Lazy.Vault EvalPW Build</span><span>
</span><a name="line-155"></a><span class="hs-keyword">type</span><span> </span><a name="EvalP"><a href="Reactive.Banana.Prim.Types.html#EvalP"><span class="hs-identifier">EvalP</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.RWSIO.html#RWSIOT"><span class="hs-identifier hs-type">RWSIOT</span></a><span> </span><a href="Reactive.Banana.Prim.Types.html#BuildR"><span class="hs-identifier hs-type">BuildR</span></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#EvalPW"><span class="hs-identifier hs-type">EvalPW</span></a><span class="hs-special">,</span><a href="Reactive.Banana.Prim.Types.html#BuildW"><span class="hs-identifier hs-type">BuildW</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-type">Lazy</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Vault</span><span> </span><span class="hs-identifier hs-type">IO</span><span>
</span><a name="line-156"></a><span>    </span><span class="hs-comment">-- writer : (latch updates, IO action)</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-comment">-- state  : current pulse values</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- Computation with a timestamp that indicates the last time it was performed.</span><span>
</span><a name="line-160"></a><span class="hs-keyword">type</span><span> </span><a name="EvalL"><a href="Reactive.Banana.Prim.Types.html#EvalL"><span class="hs-identifier">EvalL</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Trans.ReaderWriterIO.html#ReaderWriterIOT"><span class="hs-identifier hs-type">ReaderWriterIOT</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-comment">{-----------------------------------------------------------------------------
    Show functions for debugging
------------------------------------------------------------------------------}</span><span>
</span><a name="line-165"></a><span class="hs-identifier">printNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#SomeNode"><span class="hs-identifier hs-type">SomeNode</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-166"></a><a name="printNode"><a href="Reactive.Banana.Prim.Types.html#printNode"><span class="hs-identifier">printNode</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#P"><span class="hs-identifier hs-var">P</span></a><span> </span><a name="local-1627439240"><a href="#local-1627439240"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">_nameP</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Reactive.Banana.Prim.Util.html#readRef"><span class="hs-identifier hs-var">readRef</span></a><span> </span><a href="#local-1627439240"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-167"></a><span class="hs-identifier">printNode</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#L"><span class="hs-identifier hs-var">L</span></a><span> </span><a name="local-1627439241"><a href="#local-1627439241"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-string">&quot;L&quot;</span><span>
</span><a name="line-168"></a><span class="hs-identifier">printNode</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#O"><span class="hs-identifier hs-var">O</span></a><span> </span><a name="local-1627439242"><a href="#local-1627439242"><span class="hs-identifier">o</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-string">&quot;O&quot;</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">{-----------------------------------------------------------------------------
    Time monoid
------------------------------------------------------------------------------}</span><span>
</span><a name="line-173"></a><span class="hs-comment">-- | A timestamp local to this program run.</span><span>
</span><a name="line-174"></a><span class="hs-comment">--</span><span>
</span><a name="line-175"></a><span class="hs-comment">-- Useful e.g. for controlling cache validity.</span><span>
</span><a name="line-176"></a><span class="hs-keyword">newtype</span><span> </span><a name="Time"><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier">Time</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="T"><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier">T</span></a></a><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | Before the beginning of time. See Note [TimeStamp]</span><span>
</span><a name="line-179"></a><span class="hs-identifier">agesAgo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span>
</span><a name="line-180"></a><a name="agesAgo"><a href="Reactive.Banana.Prim.Types.html#agesAgo"><span class="hs-identifier">agesAgo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span class="hs-identifier">beginning</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span>
</span><a name="line-183"></a><a name="beginning"><a href="Reactive.Banana.Prim.Types.html#beginning"><span class="hs-identifier">beginning</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-identifier">next</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span>
</span><a name="line-186"></a><a name="next"><a href="Reactive.Banana.Prim.Types.html#next"><span class="hs-identifier">next</span></a></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-1627439243"><a href="#local-1627439243"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><a href="#local-1627439243"><span class="hs-identifier hs-var">n</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-187"></a><span>
</span><a name="line-188"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="Reactive.Banana.Prim.Types.html#Time"><span class="hs-identifier hs-type">Time</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-189"></a><span>    </span><a name="local-805306883"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-1627439244"><a href="#local-1627439244"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-1627439245"><a href="#local-1627439245"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">max</span><span> </span><a href="#local-1627439244"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-1627439245"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-190"></a><span>    </span><a name="local-805306882"><span class="hs-identifier">mempty</span></a><span>              </span><span class="hs-glyph">=</span><span> </span><a href="Reactive.Banana.Prim.Types.html#beginning"><span class="hs-identifier hs-var">beginning</span></a><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">{-----------------------------------------------------------------------------
    Notes
------------------------------------------------------------------------------}</span><span>
</span><a name="line-195"></a><span class="hs-comment">{- Note [Timestamp]

The time stamp indicates how recent the current value is.

For Pulse:
During pulse evaluation, a time stamp equal to the current
time indicates that the pulse has already been evaluated in this phase.

For Latch:
The timestamp indicates the last time at which the latch has been written to.

    agesAgo   = The latch has never been written to.
    beginning = The latch has been written to before everything starts.

The second description is ensured by the fact that the network
writes timestamps that begin at time `next beginning`.

-}</span><span>
</span><a name="line-213"></a></pre></body></html>